{"componentChunkName":"component---src-templates-blog-post-js","path":"/wk-10-gan-vector-arithmetic/","result":{"data":{"site":{"siteMetadata":{"title":"Vyn's Blog"}},"markdownRemark":{"id":"45262ec5-2062-5cdb-a93e-2836910fd016","excerpt":"Retry vector arithmetic VAE using averages of latent variables  Result seems very similar to last week’s. Average images seem to have the correct features…","html":"<h2>Retry vector arithmetic VAE using averages of latent variables</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/6ab075cb02b4ade06e71bafff7bfe876/95c6e/vector_arithmetic_result_vae.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.50632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAGAABAQADAAAAAAAAAAAAAAAAAAMBAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAejmzLUaN5lTA//EAB0QAAECBwAAAAAAAAAAAAAAAAISMwABAxARIjH/2gAIAQEAAQUCkwTUI0RkbHyg3//EABcRAAMBAAAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8Br0//xAAWEQADAAAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BqP/EABsQAAEFAQEAAAAAAAAAAAAAAAABEBESMdEC/9oACAEBAAY/Al6eetWSLYa6H//EAB0QAAEEAgMAAAAAAAAAAAAAAAEAESExYXEQobH/2gAIAQEAAT8hdkwkJjQpAbUTd2ixeyTPI4W6XaPq/9oADAMBAAIAAwAAABAvwEL/xAAYEQADAQEAAAAAAAAAAAAAAAAAARExEP/aAAgBAwEBPxCq8Wmh/8QAGBEBAQADAAAAAAAAAAAAAAAAAQAQETH/2gAIAQIBAT8QR1huC//EAB8QAQACAgICAwAAAAAAAAAAAAEAESFRQZEQMXHR8P/aAAgBAQABPxDEYEOPg5lxUVa5O5uc7uDsNdC/2IVeoBQXiBsinVeAKp6VdRKy39if/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vector arithmetic result VAE\"\n        title=\"Vector arithmetic result VAE\"\n        src=\"/vynsblog/static/6ab075cb02b4ade06e71bafff7bfe876/828fb/vector_arithmetic_result_vae.jpg\"\n        srcset=\"/vynsblog/static/6ab075cb02b4ade06e71bafff7bfe876/ff44c/vector_arithmetic_result_vae.jpg 158w,\n/vynsblog/static/6ab075cb02b4ade06e71bafff7bfe876/a6688/vector_arithmetic_result_vae.jpg 315w,\n/vynsblog/static/6ab075cb02b4ade06e71bafff7bfe876/828fb/vector_arithmetic_result_vae.jpg 630w,\n/vynsblog/static/6ab075cb02b4ade06e71bafff7bfe876/0ede0/vector_arithmetic_result_vae.jpg 945w,\n/vynsblog/static/6ab075cb02b4ade06e71bafff7bfe876/95c6e/vector_arithmetic_result_vae.jpg 972w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Result seems very similar to last week’s.</li>\n<li>Average images seem to have the correct features though. Not overlapping faces.</li>\n<li>Images are extra blurry if latent space is averaged.</li>\n</ul>\n<h2>Review on GAN</h2>\n<p><img src=\"https://miro.medium.com/max/563/1*Kd7mvyPqo39nytiC-JZ6uA.png\" alt=\"Gan network diagram\"></p>\n<ul>\n<li>Notice the latent space of a GAN is only loosely related to the input data from the training process. Weights get adjusted to construct an image that resembles a real world image.</li>\n<li>The generator turns random noise into images.</li>\n<li>Latent space is not created from input image.</li>\n<li>Images that come out of the generator model don’t necessarily resemble the dataset.</li>\n</ul>\n<h2>Building the baseline model</h2>\n<h4>Generator model</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"sequential_1\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ndense_1 <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3200</span><span class=\"token punctuation\">)</span>              <span class=\"token number\">323200</span>\n_________________________________________________________________\nleaky_re_lu_5 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3200</span><span class=\"token punctuation\">)</span>              <span class=\"token number\">0</span>\n_________________________________________________________________\nreshape <span class=\"token punctuation\">(</span>Reshape<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>         <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose <span class=\"token punctuation\">(</span>Conv2DTran <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">262272</span>\n_________________________________________________________________\nleaky_re_lu_6 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose_1 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">262272</span>\n_________________________________________________________________\nleaky_re_lu_7 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose_2 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">262272</span>\n_________________________________________________________________\nleaky_re_lu_8 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose_3 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">262272</span>\n_________________________________________________________________\nleaky_re_lu_9 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_5 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>         <span class=\"token number\">9603</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">381</span><span class=\"token punctuation\">,</span><span class=\"token number\">891</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">381</span><span class=\"token punctuation\">,</span><span class=\"token number\">891</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n_________________________________________________________________</code></pre></div>\n<h4>Discriminator model</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"sequential\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nconv2d <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">9728</span>\n_________________________________________________________________\nleaky_re_lu <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>      <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_1 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">409728</span>\n_________________________________________________________________\nleaky_re_lu_1 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_2 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">409728</span>\n_________________________________________________________________\nleaky_re_lu_2 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_3 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">409728</span>\n_________________________________________________________________\nleaky_re_lu_3 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_4 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>         <span class=\"token number\">409728</span>\n_________________________________________________________________\nleaky_re_lu_4 <span class=\"token punctuation\">(</span>LeakyReLU<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>         <span class=\"token number\">0</span>\n_________________________________________________________________\nflatten <span class=\"token punctuation\">(</span>Flatten<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3200</span><span class=\"token punctuation\">)</span>              <span class=\"token number\">0</span>\n_________________________________________________________________\ndropout <span class=\"token punctuation\">(</span>Dropout<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3200</span><span class=\"token punctuation\">)</span>              <span class=\"token number\">0</span>\n_________________________________________________________________\ndense <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>                <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>                 <span class=\"token number\">3201</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">651</span><span class=\"token punctuation\">,</span><span class=\"token number\">841</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">651</span><span class=\"token punctuation\">,</span><span class=\"token number\">841</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n_________________________________________________________________</code></pre></div>\n<h4>Entire model</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"sequential_2\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nsequential_1 <span class=\"token punctuation\">(</span>Sequential<span class=\"token punctuation\">)</span>    <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>         <span class=\"token number\">1381891</span>\n_________________________________________________________________\nsequential <span class=\"token punctuation\">(</span>Sequential<span class=\"token punctuation\">)</span>      <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>                 <span class=\"token number\">1651841</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">033</span><span class=\"token punctuation\">,</span><span class=\"token number\">732</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">381</span><span class=\"token punctuation\">,</span><span class=\"token number\">891</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">651</span><span class=\"token punctuation\">,</span><span class=\"token number\">841</span>\n_________________________________________________________________</code></pre></div>\n<p>To train this model, performance was evaluated every 10 epochs. It is possible\nto overtrain GANs, so the training process generated an image like the one below\nevery 10 epochs. The best image was then selected. The image below is after 40\nepochs.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/cc198d164c984bb72740326a4df1c9b7/6af66/generated_plot_e040.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAADA0lEQVQ4y62U61MaVxiH/a/7qTO9zGiqzcWoaAUXWUDYXW7LbXG5g4sIKBdDFLGIRkrVVpuYZATRJ6OtceznnE/vp+c8v/PO74wB3N7e8i3OHWfsAXb5zwXHnTbDj++5vPibbrfLp796XJ716B8f8fn9OR/PT/nz6Ijzkz4XJ39w3O1w0nvH7+0WNzc395yxh2F30yBgmWYv4SPjdzM385qDtEQr5UKYnmQ7E2U7pWL4JSqrKpWoQkQ0YWheVNsC18PBf8DR6H4w9AAh8RV5WWQrIlFVRYpeK1tBkYLrJTGHGdfMc5KylawiUJTmmfj5e4IukWY2wnBw9dSw294hojjR3WbeGDqHrQa6bY64y0JBEailY6yFFFrxAJpb5LeXkxQ8AjXdy2HGw+h6+NSwlE2iLs2xn5RpJf1shiQ2Qi6KEYVSyElJ86C7Bc7aTWS7lcnxn1j3CWSVJaKzP3J1dfUUWMkmySg2srJAIeBgQ3VT8i6Rl8yElufJ+Oxo4gIJv0TEKaDZLRiKBd1pwfbLDwwGg6eR9yprVMIreK0LZP0OarqbQlihGg+yri6T8LvQJDsx1UfLiHKUD1GKKGRV+f6Cx8g3/xq+WYuj22YQ516w6pgnI05R21hjv16irC6S13zoio1OvcxBOUktukIuqFCMRyildB6SfgXWjSTy4ivk2QkCwiwe0xSaOI3PasIvLFCKrrAVXuJtTmNDk9Ft0+TDHuprKbaLBtfD/xm2y1lyHitJlxXH4gIvpp6j2RdpJgI0VAvVRJCEtExaGCfnWUSeHScTVgm77Hjnf73rCXcd+fqGB9UCcacZs2mamMdJbdWHocpsp8KseyzkgjKSeRbVNEEzt0pzs0xwxUJalQiLJkaj66eG++tx6gELtrln+JdNNGIeUrIVw+9g5dl3bK6qpGQblaTKTi7CbjpAIx1kv5ynqEcfl/LQ5Q8n7/jc26PVqLC3XeWss0dnp0G/s0u7nKfXaXO42+TTxSmn3X16uw2uL88ZXH7gvN9/XMq3/m2+AJwgAkhfB39oAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Generated output of GAN\"\n        title=\"Generated output of GAN\"\n        src=\"/vynsblog/static/cc198d164c984bb72740326a4df1c9b7/f058b/generated_plot_e040.png\"\n        srcset=\"/vynsblog/static/cc198d164c984bb72740326a4df1c9b7/c26ae/generated_plot_e040.png 158w,\n/vynsblog/static/cc198d164c984bb72740326a4df1c9b7/6bdcf/generated_plot_e040.png 315w,\n/vynsblog/static/cc198d164c984bb72740326a4df1c9b7/f058b/generated_plot_e040.png 630w,\n/vynsblog/static/cc198d164c984bb72740326a4df1c9b7/6af66/generated_plot_e040.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Generated faces of GANs look creepy. I think this is because humans know exactly what faces should look like, and any slight deviations trigger a threat response.</li>\n<li>Most faces have all the correct features: (2 eyes, nose, mouth, somewhat normal shape)</li>\n</ul>\n<h2>Vector arithmetic using the baseline model</h2>\n<p><code class=\"language-text\">Smiling woman - Neutral woman + Neutral man = Smiling man</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/483c94ccb107beac5dee757dd955fd47/13b9d/vector_arithmetic_result_gan.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 138.60759493670886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAcABQDASIAAhEBAxEB/8QAGQAAAwADAAAAAAAAAAAAAAAAAAEDAgQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAeraNRsAmnWjrAQX/8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxAREv/aAAgBAQABBQIJyIOZy2L6z00Qkw2INNaE/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAdEAACAQQDAAAAAAAAAAAAAAAAARACEiEyESIz/9oACAEBAAY/At2PPMbI7OPMd1NpmpTqj//EAB4QAQABBAIDAAAAAAAAAAAAAAEAEBEhQVFhMXGh/9oACAEBAAE/IVyvtuYuZ5bo3NOdQlbDxYo/fudcW/MRsB9xO2EQKiz/2gAMAwEAAgADAAAAEHAOT//EABgRAAIDAAAAAAAAAAAAAAAAAAABEBEh/9oACAEDAQE/EHFmH//EABcRAAMBAAAAAAAAAAAAAAAAAAABECH/2gAIAQIBAT8QV0//xAAeEAACAgIDAQEAAAAAAAAAAAABEQAhMUEQYXFR8f/aAAgBAQABPxA47JZ7TKH2NdcEGUpBe2xge8DkiwWI3+zThRsxFwxFmQYp9N/YLBd+wocGSRmf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vector arithmetic GAN\"\n        title=\"Vector arithmetic GAN\"\n        src=\"/vynsblog/static/483c94ccb107beac5dee757dd955fd47/828fb/vector_arithmetic_result_gan.jpg\"\n        srcset=\"/vynsblog/static/483c94ccb107beac5dee757dd955fd47/ff44c/vector_arithmetic_result_gan.jpg 158w,\n/vynsblog/static/483c94ccb107beac5dee757dd955fd47/a6688/vector_arithmetic_result_gan.jpg 315w,\n/vynsblog/static/483c94ccb107beac5dee757dd955fd47/828fb/vector_arithmetic_result_gan.jpg 630w,\n/vynsblog/static/483c94ccb107beac5dee757dd955fd47/0ede0/vector_arithmetic_result_gan.jpg 945w,\n/vynsblog/static/483c94ccb107beac5dee757dd955fd47/3ac88/vector_arithmetic_result_gan.jpg 1260w,\n/vynsblog/static/483c94ccb107beac5dee757dd955fd47/13b9d/vector_arithmetic_result_gan.jpg 1271w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Result is definately better than VAE.</li>\n<li>Output of GAN is not blurry.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f94d07c2da80c0b2f8e28459e151f664/c2601/gan_vec_arith_2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 148.7341772151899%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAIB/9oADAMBAAIQAxAAAAHUXROU8oKUTvji1AEf/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQIAEQMSMxP/2gAIAQEAAQUC0QNSa+KxulXjjdCSEjdchrFP/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPwFqK//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EAB8QAAECBwEBAAAAAAAAAAAAAAABAhARIjFSctFBUf/aAAgBAQAGPwJEqJ13PRvRJSvlBvBNsYNE2+w//8QAIBAAAgEDBAMAAAAAAAAAAAAAAREAECFRMUFhgZGh8P/aAAgBAQABPyEqm7xColyT7GcbQ4QEIBd1H6jn7iSJFDH2O8Z1jqp//9oADAMBAAIAAwAAABDY+rz/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREQ/9oACAEDAQE/EEUJZn//xAAXEQEBAQEAAAAAAAAAAAAAAAABABAR/9oACAECAQE/EG4S5//EACAQAQABBAICAwAAAAAAAAAAAAERADFBURAhgcGR0fD/2gAIAQEAAT8QlQJYjsRurFUEBEfqlmZoYZ2Sb4zV4QWVAnfrhQyY/BhSCio6JvHvgTcZpkeCkBQbi68f/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vector arithmetic GAN 2\"\n        title=\"Vector arithmetic GAN 2\"\n        src=\"/vynsblog/static/f94d07c2da80c0b2f8e28459e151f664/828fb/gan_vec_arith_2.jpg\"\n        srcset=\"/vynsblog/static/f94d07c2da80c0b2f8e28459e151f664/ff44c/gan_vec_arith_2.jpg 158w,\n/vynsblog/static/f94d07c2da80c0b2f8e28459e151f664/a6688/gan_vec_arith_2.jpg 315w,\n/vynsblog/static/f94d07c2da80c0b2f8e28459e151f664/828fb/gan_vec_arith_2.jpg 630w,\n/vynsblog/static/f94d07c2da80c0b2f8e28459e151f664/c2601/gan_vec_arith_2.jpg 832w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Potential performance improvements</h2>\n<ul>\n<li>Some noise (100 random normal points) generates bad images.</li>\n</ul>\n<p>Example bad image:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/e4e924bd01c322200c8df62f3a70be45/1bba8/bad_output_generator.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 113.29113924050634%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAADA0lEQVQ4y62TW0iTYRjHdxMEBUWEgRplw3nCuZMsIbJ52sAKo6sugpA5IrFpczlR6dqIoKCrLiLKcsZyOg8RgReahqZJUJnaQQlMA3dQt/Z93/aP552fh3aAwgf+7N3zPO/v/b/f93wSlUqFWFIqley3rEyPcoMeZ8sNKCou2laLJUm8gkqlhFKlhjo3B62m43hsOQOdRg15AlhiIG1Ua5CXKUXLhWw8MutxvvQksuV5UP8rULySQqmEPDsT0tQU6NQ5OKFVI1eel/DacR0qFEoUFBSguKQExaWlKNQV45ROB61Wm/gZajQa/K38/HwoFApUVFTAZrOh3mKBtd7C1gaDgQGpJ9ZeSUZGBmQyWZQon56eDqlUuk2Ui9Uv7pFUVVUhnkwmE4xGIywWC8xmM1tTLl5vZWUlJNjBCAQCkHAcB9LKygr8fn9cra1FFKu2urqKUCgEj8cDiSAILOl2u0Frnuc3xHE8AkEOCIdw8f4wmhyTzMnvILfRI+4nUz6fDxJKhsNhlkwUhTcHcOnBKFsLofC2GsGIw4B0AlkmuxQEJ1EsePx4+WEBjY73SG/qQ82TCZbnhdC2vmAwuAmkBYXokJpoA4W5/R32VDtwsNaJvdUOXLNHrsyHEgBFh16vNxr4dAL7r3Yiq6UfB8yduNI2Hrniev2/HO6reY5jjb04fN2FjOY+FN0awKIvwOqheA5pfuhPLIci8GhDD5Lru3GkoYc9260vJwoozqF4qgiss286JJDo8seyOBFxgDSUBBRPdK8Fce7eEHJvvECq1cVgDGh1QdbUB39QiHwZnMCQUUCeFzYcUkzOuxkoxepCGl3X1oM0W8SltLEXd15Nw/hwDKfvDkZ8Cjy4rS+Fnpvb60Nr/0fobw/gsLUbyRYnDtU5kVTbiaS6ddVGtPtyB3aZ7Mhq7sXw7C/8XPYhLAjwig5Ji0tLsI/MoG1oGu2Dn+CamEPH6yk4x77C8WaGqXv8O56NfEbf5Dyco7PoGvuCrrffMDW3wJx6vN7NsdmJoFn+A3QlP4r/pVduAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Bad image from generator\"\n        title=\"Bad image from generator\"\n        src=\"/vynsblog/static/e4e924bd01c322200c8df62f3a70be45/f058b/bad_output_generator.png\"\n        srcset=\"/vynsblog/static/e4e924bd01c322200c8df62f3a70be45/c26ae/bad_output_generator.png 158w,\n/vynsblog/static/e4e924bd01c322200c8df62f3a70be45/6bdcf/bad_output_generator.png 315w,\n/vynsblog/static/e4e924bd01c322200c8df62f3a70be45/f058b/bad_output_generator.png 630w,\n/vynsblog/static/e4e924bd01c322200c8df62f3a70be45/1bba8/bad_output_generator.png 642w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>What type of noise generates good images?</li>\n<li>Perhaps we can use the discriminator model to determine if the image is good or not?</li>\n<li>Maybe we can try to get the generator model to recreate images from the dataset by trying many different latent vectors and seeing which one is the closest. Then maybe train an encoder model to create those vectors based on a given image from the dataset.\n<ul>\n<li>I tried with without much luck</li>\n</ul>\n</li>\n<li>Can we classify noise that will yield a ‘real’ image from the generator versus noise that will yield a fake image?</li>\n</ul>","frontmatter":{"title":"Vector Arithmetic with GAN","date":"March 11, 2022","description":"Building a GAN to retry experiments from last week"}},"previous":{"fields":{"slug":"/wk-8-vector-arithmetic/"},"frontmatter":{"title":"Vector Arithmetic with VAE"}},"next":{"fields":{"slug":"/wk-11-gan-optimizations/"},"frontmatter":{"title":"GAN Optimization Experiments"}}},"pageContext":{"id":"45262ec5-2062-5cdb-a93e-2836910fd016","previousPostId":"c6a8c8e1-0f57-50ad-898c-57f72b7e7702","nextPostId":"01ea8553-366c-5441-b334-2a551b66a0f1"}},"staticQueryHashes":["2841359383"]}