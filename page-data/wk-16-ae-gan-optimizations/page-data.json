{"componentChunkName":"component---src-templates-blog-post-js","path":"/wk-16-ae-gan-optimizations/","result":{"data":{"site":{"siteMetadata":{"title":"Vyn's Blog"}},"markdownRemark":{"id":"671efa06-3184-59a1-ad9f-a7f3ec9a6fec","excerpt":"AE-GAN version 1 Changes from previous model (test model from last week) New loss function Want GAN loss to increase as AE loss decreases. Do this by scaling…","html":"<hr>\n<h2>AE-GAN version 1</h2>\n<h3>Changes from previous model (test model from last week)</h3>\n<h4>New loss function</h4>\n<ul>\n<li>Want GAN loss to increase as AE loss decreases.</li>\n<li>Do this by scaling the GAN loss by 1 / AE loss.</li>\n<li>Need 0.0005 scalar multiplier in order to keep GAN loss the same order of magnitude as AE loss.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">loss_wapper</span><span class=\"token punctuation\">(</span>g_model<span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">,</span> beta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mse <span class=\"token operator\">=</span> MeanSquaredError<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    bce <span class=\"token operator\">=</span> BinaryCrossentropy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">loss</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># run data through generator</span>\n        y <span class=\"token operator\">=</span> g_model<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># calculate typical loss functions</span>\n        ae <span class=\"token operator\">=</span> mse<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n        gan <span class=\"token operator\">=</span> bce<span class=\"token punctuation\">(</span>y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># scale ae loss and invert</span>\n        ae_loss <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span>scalar_mul<span class=\"token punctuation\">(</span>alpha<span class=\"token punctuation\">,</span> ae<span class=\"token punctuation\">)</span>\n        ae_loss_inverted <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> ae_loss\n\n        <span class=\"token comment\"># gan_loss should = gan_loss * 0.0005 * (1/ae_loss) Hopefully that will allow recovery from convergence f ailure</span>\n        gan_loss_scaled <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span>scalar_mul<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">,</span> gan<span class=\"token punctuation\">)</span>\n        gan_loss <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span>multiply<span class=\"token punctuation\">(</span>gan_loss_scaled<span class=\"token punctuation\">,</span> ae_loss_inverted<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># record results for analysis</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"./</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">/data/alpha_beta_loss_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">.csv\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n            f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>ae<span class=\"token punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>gan<span class=\"token punctuation\">}</span></span><span class=\"token string\">\\n\"</span></span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> ae_loss <span class=\"token operator\">+</span> gan_loss\n\n    <span class=\"token keyword\">return</span> loss</code></pre></div>\n<h4>Batch size</h4>\n<ul>\n<li>Changed from 128 to 256. This makes 195 batches per epoch since dataset is 50,000 images.</li>\n</ul>\n<h3>Results</h3>\n<h2><img src=\"/vynsblog/4e3fb64cc52fb1a3a4424fcd0ba5f7b0/aegan_inverse_1_in_out.svg\" alt=\"\"></h2>\n<hr>\n<p><img src=\"/vynsblog/1dc6fe58be5784fad88e162655a047f6/aegan_inverse1_training.gif\" alt=\"\"></p>\n<h3>Observations</h3>\n<ul>\n<li>Smiles seem to change slightly. This is probably due to the generative characteristics of the model.</li>\n<li>Faces have slight changes that are not necessarily reconstructions.</li>\n<li>Images are still relatively blury, (see metrics section).</li>\n</ul>\n<h3>Data</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/06e64ad21fd9020ae8cf195f130e53f1/6af66/aegan_inverse1_generator_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAByklEQVQ4y4WUy47TMBSG55FZ8ACseBJYsUKCDbcVW0aCESDRi1rRaYc2sR3bcS6N/SG7TabttDOWfkWx4+/859gnVwAhBC6N7XZL0zRJbdvy2Iicqx7WtC2lc1RVleSco65rFosF4/GYyWTCbDYjlwVlWWKMGWStxXufOAPQaEVrZVroum7Qofv4LrVhPp8zGo1SoBgwy7JkIgF3VkErQSjFxVTSM7pooiuNUiopliQGihkNwM57dKHwxTLRwx5yqgQ9EzACjxx6HyiUwmdj8N1uU5/qIexCkAfAOB+L62+/Q2MJjR1gvWPOwM4C46QUAmUc/vo1FLeE2gwwDt1eqO0DYNs0aOvwv96BE4S7n/e7fHfk9klgvxhP2Zs15FPC++fw5wOsbo5hh44fq6EPYXfK/34TRp8IH18Qrl8RvrxMbsP+yuzq5vfqgeEE2F9sYwj5BPLRfU6thcln0MtHWy42w8m18UgpELYhdx5ha4S2iBbk9Bvt22f4H2/opl/pljd0mzGt+IsTKyq5oi41VVUft17sxyzPsaVDSIUqDLYsyZXBqBybLVDrBZVaY+UGmd3hrEbmG7QuUtpHQC72ARhbshGSp76Mf5v/FdKR8xPbJckAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse1 generator loss\"\n        title=\"aegan inverse1 generator loss\"\n        src=\"/vynsblog/static/06e64ad21fd9020ae8cf195f130e53f1/f058b/aegan_inverse1_generator_loss.png\"\n        srcset=\"/vynsblog/static/06e64ad21fd9020ae8cf195f130e53f1/c26ae/aegan_inverse1_generator_loss.png 158w,\n/vynsblog/static/06e64ad21fd9020ae8cf195f130e53f1/6bdcf/aegan_inverse1_generator_loss.png 315w,\n/vynsblog/static/06e64ad21fd9020ae8cf195f130e53f1/f058b/aegan_inverse1_generator_loss.png 630w,\n/vynsblog/static/06e64ad21fd9020ae8cf195f130e53f1/6af66/aegan_inverse1_generator_loss.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/2eb20fd7fc327565f0c0e8fee694fdd4/6af66/aegan_inverse1_discriminator_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABzElEQVQ4y5WUS4/TMBSF+/f5BSyALbNgi0BiVc1s0IBAiEU1DC2PVpm+kjh+xEls50NOHySjVIgrncSxr0/OfdgTgLZtGbM4X9f1AN57Lln0n5zIorMpS6y1lGVJVVVIKZnP5wNsNmusrVDaoJVCKYUxhhBCxzOJj/ghigKnM4Kr8SF0SuJ8X30cR5jSstunLBYLZrMZy+WyE9QRnjbYqiaoLYRmNJTj4PD2Nd5KikKSZRl5nncRDRQWUhH0rnNue2pGMfLDmKqewpbSVvio0DdnwscF68/14Zz7S3hwCBRKE9RB4Sm8x9UfI+wy4P1QoRACbSxB70dDvtRaFwljhWIOnUi6oqjK0/hw2nasxX8QRiuNodl869pmLUq8d4e2OfbXWW0Po4QnZykLfPIV38IqSbpF4cCd8xl66KejHVdoygrx8RXp+5es3zzh5+1r7t4+xdzf8C+LB2GgMIaW5oLfn96R/vjC9voFm+kzHqbPUR+uqO6nNN+vcfMb3OozzfqOOltR5wmNSKiN7NpuoFBrTZqmuACqAeMhnhlpHXL/gNqtEOtfWLFF5zvy/QarJSLdomK6jpfGZPSmCR7aI2hRpmSf5YM6txdumz8zy5KrZYOFWgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse1 discriminator loss\"\n        title=\"aegan inverse1 discriminator loss\"\n        src=\"/vynsblog/static/2eb20fd7fc327565f0c0e8fee694fdd4/f058b/aegan_inverse1_discriminator_loss.png\"\n        srcset=\"/vynsblog/static/2eb20fd7fc327565f0c0e8fee694fdd4/c26ae/aegan_inverse1_discriminator_loss.png 158w,\n/vynsblog/static/2eb20fd7fc327565f0c0e8fee694fdd4/6bdcf/aegan_inverse1_discriminator_loss.png 315w,\n/vynsblog/static/2eb20fd7fc327565f0c0e8fee694fdd4/f058b/aegan_inverse1_discriminator_loss.png 630w,\n/vynsblog/static/2eb20fd7fc327565f0c0e8fee694fdd4/6af66/aegan_inverse1_discriminator_loss.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/68af0f32be9a60b71465541a4bd95029/6af66/aegan_inverse1_discriminator_accuracy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABe0lEQVQ4y6VUa1PDIBD0//+6frStmnZ8jDEQIMDxCGQdqElbtbUz3syGSyA7u9zB3TRNuBRxHBFirCj5jEt/FK67kozjCOcciCys0bBmAFmN5/0OD5t7bNf3aB632D094HG7Ae9aOGtg9QCqay1SzpW0EqphgOAM8n0H3T0jDh0MewV72WLyGqMVZwiaL4iaw5OBc/5AOFsORsJ3zdFumsAGOljB9cg5V4eLQucD+o83JL47EFT507Iv11AipXQkPEwAepAgxX6QzO+XivCDUGsN5whKWwgb/k+olELf9+iFhDwhvCV+JRRCwDsHSw7C+P8TlgcRoWMcisJNFv8sSglt6UzhX5W92jbFMuM9FMXb+m4Cwpjgva9EMxbCnBOEVJDG1R7MXyhWvudFIVkD1rVYrzdYrVZomgYhhHPLZR9LtcuElLLmMUZwzlEKVxS0bYvSZp4s3t9eIJWqa/f7fb0PFoXf+62M+euw17OuFBhjVeUc6WR+/l5um0/rcJip1FeIUwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse1 discriminator accuracy\"\n        title=\"aegan inverse1 discriminator accuracy\"\n        src=\"/vynsblog/static/68af0f32be9a60b71465541a4bd95029/f058b/aegan_inverse1_discriminator_accuracy.png\"\n        srcset=\"/vynsblog/static/68af0f32be9a60b71465541a4bd95029/c26ae/aegan_inverse1_discriminator_accuracy.png 158w,\n/vynsblog/static/68af0f32be9a60b71465541a4bd95029/6bdcf/aegan_inverse1_discriminator_accuracy.png 315w,\n/vynsblog/static/68af0f32be9a60b71465541a4bd95029/f058b/aegan_inverse1_discriminator_accuracy.png 630w,\n/vynsblog/static/68af0f32be9a60b71465541a4bd95029/6af66/aegan_inverse1_discriminator_accuracy.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Vector Arithmetic</h3>\n<p><strong>Top row</strong>: smiling women (last column is average latent vector output)</p>\n<p><strong>Middle row</strong>: neutral women</p>\n<p><strong>Bottom row</strong>: neutral men</p>\n<p><strong>Last image</strong>: smiling women - neutral women + neutral man\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f92214b01a3460181e600767c8ff9a93/6af66/aegan_inverse1_vector_arithmetic.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACr0lEQVQ4y52USU+TURSG+Qv+E13p1rhyYdwJxmjSRHBhSFiYKIigwbmoSJkaoIjMgk0LtIW2WKgyWCi0RVqGoqIUKUPBEKZvekw/qGAgIXI293vPPffJe07u/ZIAFEXhyDiiJsFISnysb2wS8HmZnfjC8sI8sqIQCYeIzYT5HVskXrUSnWNjKcr62iqSLDM7Pcnqz6+sLMz/hSYpiqyKX5EftGiz6S/JI9DVzubWFpXpV7BkphLqsapAR8UrPFUFBLptCJKELf8eXl0uvvamHaAs7zmMzUcI1uuYaijH22lGEAX0N1IwZ1wn7LYjAbZiLR8LnjHW40CUJNy6PEaLHhKwtBwCjC3jbjLgMdbxyd2j2v9oqsVvbSI85lMddhlrcNRX4ulzq7rPXMeIuZaBbudB4GI0SuuLHJ5cu0iDwRDfxq7PorMkg1F3K6IMjXeTsdy/wNui5+oZZ+EtLA+u0lyqVbUsSyTFqfGIRCLo0zUUppzH9LZKzTlKb9NruMN4r5mNbZmy1LOYU09ir8pHUMCYo8GZdQlndcEhLa/E8DhbGW6rwT80oOaCrmbGrJVEJocRZHDVFTHw5ik9dou6P2KrJ2jS43XZDgLX12L42nTU5V7G29Ucb4CFlky+V6QRstaqNUudZQw91mApz1d1tLOAYKGG/poXu0DpX2DL8zSST52grb4ERRQZ1abgTj+DsXQHEGjU0n/zHC79I1WPVWfSnnYa08vsfTPcBQrCNlOj/Thb3/EtPI4oSgS7rUw4jfh9fiQFQoN9zA1+YCbkZ1uU8HU0MtFuYMhl32v5uE9P2Nog6qhl2aRj6XOHeo1Q9s0wvsYtS5KILMs7WpKQE3q3pXhuB7jF9PtiPt/T0Fv1em+G/GckDGwLAtM+D5HhXsYDvr23zDHisBEl/jZ/AKVJLXXOd7a6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse1 vector arithmetic\"\n        title=\"aegan inverse1 vector arithmetic\"\n        src=\"/vynsblog/static/f92214b01a3460181e600767c8ff9a93/f058b/aegan_inverse1_vector_arithmetic.png\"\n        srcset=\"/vynsblog/static/f92214b01a3460181e600767c8ff9a93/c26ae/aegan_inverse1_vector_arithmetic.png 158w,\n/vynsblog/static/f92214b01a3460181e600767c8ff9a93/6bdcf/aegan_inverse1_vector_arithmetic.png 315w,\n/vynsblog/static/f92214b01a3460181e600767c8ff9a93/f058b/aegan_inverse1_vector_arithmetic.png 630w,\n/vynsblog/static/f92214b01a3460181e600767c8ff9a93/6af66/aegan_inverse1_vector_arithmetic.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>AE-GAN version 4</h2>\n<h3>Changes from previous model (version 1)</h3>\n<h4>New loss function</h4>\n<p>The idea behind this loss function was to make the gan loss beta value increase\nas the derivative of ae loss approaches 0. As the derivative approaches 0, the\nidea is that the ae process is nearing completion the closer the derivative gets\nto 0. Additionally, if the derivative becomes positive, the beta scalar will\ndecrease the same as it increased. The graph below shows a parabolic curve,\nrepresenting the ae loss value over time. The purple line is the derivative and\nthe spiky line is the negative inverse of the derivative. In practice, ‘a’ (the\ninverse scalar value) had to be adjusted to tune the steepness of the curve.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/7970d/derivative_graph.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.50632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA00lEQVQoz42SUY7DIAxEuUgbgo0xSbf3v91UQ9YUaatqP0bYZvKwraTmHbU17CLYi0BqHWJeKNUR0zN9v/VqV65mU8n7CXNHLgX3nLHt+4ip+JhxAHl/Qd5w1ukRVSR2Q3IAeWqtX4GEFXl3HlPQlwi5bdvsjicfWMejkVOwJlpR9FqJNZ+wUCIkFFCKRoJpYl7N0Hofey4q88FYTyitkHu+oLEGaw39POFHx/n4weP5hB/HEIH0hDfijx2upgF2h/dj7nG9+wcw/xlD1Ga8/gWf9ALovuGJalbnnQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"derivative graph\"\n        title=\"derivative graph\"\n        src=\"/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/f058b/derivative_graph.png\"\n        srcset=\"/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/c26ae/derivative_graph.png 158w,\n/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/6bdcf/derivative_graph.png 315w,\n/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/f058b/derivative_graph.png 630w,\n/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/40601/derivative_graph.png 945w,\n/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/78612/derivative_graph.png 1260w,\n/vynsblog/static/04b14e621ddbe188f54493d0959ee23a/7970d/derivative_graph.png 1908w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">loss_wapper</span><span class=\"token punctuation\">(</span>g_model<span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mse <span class=\"token operator\">=</span> MeanSquaredError<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    bce <span class=\"token operator\">=</span> BinaryCrossentropy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">loss</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># run data through generator</span>\n        y <span class=\"token operator\">=</span> g_model<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># calculate typical loss functions</span>\n        ae <span class=\"token operator\">=</span> mse<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n        gan <span class=\"token operator\">=</span> bce<span class=\"token punctuation\">(</span>y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># Read previously stored loss data</span>\n        df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"./</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">/data/alpha_beta_loss_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">.csv\"</span></span><span class=\"token punctuation\">)</span>\n        beta <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        <span class=\"token comment\"># calculate derivative over the last 50 batches</span>\n        <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">50</span><span class=\"token punctuation\">:</span>\n            derivative <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">\"ae_loss\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>diff<span class=\"token punctuation\">(</span>periods<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> df<span class=\"token punctuation\">[</span>\n                <span class=\"token string\">\"ae_loss\"</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span>to_series<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>diff<span class=\"token punctuation\">(</span>periods<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># calculate scaled negative inverse</span>\n            beta_vec <span class=\"token operator\">=</span> <span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.0000002</span> <span class=\"token operator\">/</span> derivative<span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># limit max beta to 1</span>\n            beta_vec <span class=\"token operator\">=</span> beta_vec<span class=\"token punctuation\">.</span><span class=\"token builtin\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fillna<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            beta <span class=\"token operator\">=</span> beta_vec<span class=\"token punctuation\">.</span>iloc<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\n        gan_loss_scaled <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span>scalar_mul<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">,</span> gan<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># record results for analysis</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"./</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">/data/alpha_beta_loss_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">.csv\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n            f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>ae<span class=\"token punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>gan<span class=\"token punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>beta<span class=\"token punctuation\">}</span></span><span class=\"token string\">\\n\"</span></span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> ae <span class=\"token operator\">+</span> gan_loss_scaled\n\n    <span class=\"token keyword\">return</span> loss</code></pre></div>\n<h3>Results</h3>\n<h2><img src=\"/vynsblog/50ae93d5faa44da3ff6e3bf0bbf66f53/aegan_inverse_4_in_out.svg\" alt=\"\"></h2>\n<hr>\n<p><img src=\"/vynsblog/cdc400da60a065491c5f2fec375f2d9b/aegan_inverse4_training.gif\" alt=\"\"></p>\n<h3>Observations</h3>\n<ul>\n<li>Eyes are much more prominent on these images. I think that is due to the GAN loss being more active in this model.</li>\n<li>Images are still pretty blury.</li>\n</ul>\n<h3>Data</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/ff2c266a4c16bc7647e1833d2c26d01a/6af66/aegan_inverse4_generator_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACDklEQVQ4y32UvYsTQRiH72+zEqwsrGxFbK6xslLwD7AVDgQRwUYOD/Q4r7JQ5KxFD5JoQsKRZL93ZvZ75pGZZDdZkjjw7sx+Pe/v/e28ewRgjOHQqOuasixdVFXF/4blHLWwsqpQWUae5y6yLKMoCmazGcPhkNFoxHg8JogSlFIIIbqQUqK1dpwje9DGIJKYSgRu3TRNF9vq7XmUCiaTCYPBwCWyCX3fdyI6YFGWJIGHEYtW/E4pbrYqSqsqJY5jF9YSm8hW5IDtw5mIadJFBzDtvBW7qTbKewobbUj8OTqaOgWmVLD2hDWcPQnaJH3g+qKKffT1BfhDTJFCITYl27WuD6ruAe1WCMMIJQXN5TP4/WkFlB7kyYoofaiLTnErYi/Qfu6qrpFSoU8fwdUJRvkg5tDUK6XJDKJJzwYOlrx2SFjg+RP4+Bhz+RTeP4DvL+HsGK7PIfizgbXeHvLQ3hBC0vz8gDl9iDk7xry7j3lzF/P2HubVbczJLczfbysfrZ8d0PSBbRbrIfEM4jE0BegKynSlZnoFX1/A6zsw/bGzbaxtvW1jL8RRSJRKlrLBE4WLUFUEIifIDSEQ/vpC9vk5OppRJ3OKeE6ZLimU2FVo+9ELQuJUuFmoDC8ISIRk6fmEYeAS2O6Q4QJvfkMmErzFDUpJ1zE94L6Waz+ASFPXrxi9KXN9T2+9b/82/wAD+oVVlOlbgAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse4 generator loss\"\n        title=\"aegan inverse4 generator loss\"\n        src=\"/vynsblog/static/ff2c266a4c16bc7647e1833d2c26d01a/f058b/aegan_inverse4_generator_loss.png\"\n        srcset=\"/vynsblog/static/ff2c266a4c16bc7647e1833d2c26d01a/c26ae/aegan_inverse4_generator_loss.png 158w,\n/vynsblog/static/ff2c266a4c16bc7647e1833d2c26d01a/6bdcf/aegan_inverse4_generator_loss.png 315w,\n/vynsblog/static/ff2c266a4c16bc7647e1833d2c26d01a/f058b/aegan_inverse4_generator_loss.png 630w,\n/vynsblog/static/ff2c266a4c16bc7647e1833d2c26d01a/6af66/aegan_inverse4_generator_loss.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/adb352547385a5722250b6f4c436e7eb/6af66/aegan_inverse4_discriminator_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAB4UlEQVQ4y32TTYvbMBCG99cWSi+9Nv+mh8JCoR8svfRSWLaH0sO2hZJDSXpIkzjxt2RLsi35WaR8bJx4KxhpZM28PDOWrgD6vmds+O9N0wzMWstTw8dfHcR8cF3XaK1RSmOMRgjBbDYb2GYTobVBVjWVlEgpQ55zLugcBf1h21mcyrGtwToXgk7pve+tVpo4SZnP50ynUxaLRQAKgn7yZZRFQUitYrDNRSl7Z7faBqsFZSnIsow8zzHGDAmN1ljv1jF9Z4L4gejCRnrnW3Uk7LouELo94angaamc7Q/m84+ChySl6icJz0s/FTu0bCDoe1CWQ8K9xJBwxB8VbNsGWVU4LUCswLZ0DqRuQ1BaNTSdG9L9TzCUrA1OFSDW4Fpa25PIHWlUKHTbBeIx0oGgn5yzlEIGwT6Z0amSpgepGmQHMo2oymzXgN6d9bAfJ2xUhfjzlez+huX9Z358v+Pvz1t+3X3i37f3FNMv1Oly9Mn5B3BG6EjTjOXta4qPE9IPE1bXL1m/e0V2/ZzkzTPk2xeImwlm+RuTR5giwuRrWrHFqOqS0P+UPNmia0mZZ3RaIrI47IssQYoSmSeU8RpZpGyjFUqWxJsVdV2FuzgQfLwkj6vbO76/cZIMy9znubN7+gDyxo1pLbMZgwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse4 discriminator loss\"\n        title=\"aegan inverse4 discriminator loss\"\n        src=\"/vynsblog/static/adb352547385a5722250b6f4c436e7eb/f058b/aegan_inverse4_discriminator_loss.png\"\n        srcset=\"/vynsblog/static/adb352547385a5722250b6f4c436e7eb/c26ae/aegan_inverse4_discriminator_loss.png 158w,\n/vynsblog/static/adb352547385a5722250b6f4c436e7eb/6bdcf/aegan_inverse4_discriminator_loss.png 315w,\n/vynsblog/static/adb352547385a5722250b6f4c436e7eb/f058b/aegan_inverse4_discriminator_loss.png 630w,\n/vynsblog/static/adb352547385a5722250b6f4c436e7eb/6af66/aegan_inverse4_discriminator_loss.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/598d3f278a38fb41bcc772e754c214cd/6af66/aegan_inverse4_discriminator_accuracy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAB00lEQVQ4y42UbW/bIBSF+/9/WD9Hq7S1SZPUTdfYsQHz/mqfCVo79taou9IVGMyjyznA3TiOuBUxJvgQSoYY57y1IrPuPhZGWGNgplQcRglUxz2et48lj/sdXg7P2O+2IG0DqyWs0XOb0lCgBSilAO05wvkXqt0DaFtD9y28YrD9Bee6RjI9omYlvSQImoGfD6D1K4QQcM5dgTEEkF7i5/4FnLbrbQDw6estUsbQcANhA5yzV6B3rkze7ymISbMeRd+i8Th/z+MAmIm4SAdh3BqYdev7Hg8nhk66GbgCL/rTN1UeF+HA9QKolCoaZB1/nBiI8ivgLTcnYKc8fIiw9hPIOQchBEoKVJ0CN+H/gdqD6QCMA4xZABljsFqh7g2Ui98Ch8+5QyvRCLcG5oXZ8lzhG9UwPt0ETmMTcPPK8JuZPHIFFpd9gFESJ6JgQ/rHgK8yR81dcTqfghXQWgcleNmyjwO+i2EEfL6WzhUzplxU6CGylsrChYhxHDAMA1JKpV32c3VGK3Rtg6enLTabDY7HY2HMwKxhNiZnnshnklKKkG8QIR+mWYumaSClhDMa9fsbes7Lv1VVlfdgNuVv0XObq5kin4Su60qVU6TF/DSeX5s/5W2S9/J5r24AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse4 discriminator accuracy\"\n        title=\"aegan inverse4 discriminator accuracy\"\n        src=\"/vynsblog/static/598d3f278a38fb41bcc772e754c214cd/f058b/aegan_inverse4_discriminator_accuracy.png\"\n        srcset=\"/vynsblog/static/598d3f278a38fb41bcc772e754c214cd/c26ae/aegan_inverse4_discriminator_accuracy.png 158w,\n/vynsblog/static/598d3f278a38fb41bcc772e754c214cd/6bdcf/aegan_inverse4_discriminator_accuracy.png 315w,\n/vynsblog/static/598d3f278a38fb41bcc772e754c214cd/f058b/aegan_inverse4_discriminator_accuracy.png 630w,\n/vynsblog/static/598d3f278a38fb41bcc772e754c214cd/6af66/aegan_inverse4_discriminator_accuracy.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Vector Arithmetic</h3>\n<p><strong>Top row</strong>: smiling women (last column is average latent vector output)</p>\n<p><strong>Middle row</strong>: neutral women</p>\n<p><strong>Bottom row</strong>: neutral men</p>\n<p><strong>Last image</strong>: smiling women - neutral women + neutral man\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f30c9d6c09b87d7095167fadabddd0df/6af66/aegan_inverse4_vector_arithmetic.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACs0lEQVQ4y52US08TURiG+Qv+E13p1rhyoS5cCJKQkAguCAmJAUVETYxyKQQiyCWUS4AWECxQaBsoSBmlaGlJC0JBahBCuVMwhEs7c+YxHSiQQGLk28y853zz5H2/kzNxAKqq8s/6R0+MERd72ds/YMLrYWn2B1vrqwhVJRjwE1oI8Ce0QbRre22Z/c019nZ3UIRg8dcM20sBdjZWTqBxqio0sRJcpEP3gtGKN0wM9nJweEhteiKW7BT8w1YNaNeX4KovZcJhI6IofMp/grMkE0+P4QgoxKnD0GqQaWMZcy01ePq6icgRqh/H053xiIDUjwLYPuiQSguYGrYTUWT6S3L5XpqLu9d4ATC0hdRWh8tk4Ks0rNn/0tWMz9pGYMqrORw0NWE31uJySpp2mBpwdTUw6rCfB26srWEufkle0j1a6uqi2/RXP6evIoNJyYwsoDXnAZbXd2gsL9S+sejS6My6T0t5vqaFohAXpUYrGAxSnZ7M+/jbdDXWa2v2yqeM1D1jZqSb/bCgKuUm3SlXsdcXEVahOSsJc/pdbHrdsUPlTOTtEK4BM+M9Tfjc37S16aF2pqy1BH+OExEwZCjnW0M+w/0Wbf+7pRmvqQKPw3Y+8t5uCG9PGYZXCXgG26MBWO/I5rc+Fb+1WevZ7KvC/S4Za02Rpue78hgreIjUUHjeYRTYUZjKg2tX6DFWoMoyk7p4pPQbmCqPABOtOkbTbjFU/VY7FHdVFk2J12kryjkzw2NgJBJmbnKUAfNH5gMzyLLCtMPK7IAJn9eHooJ/zMmy6zMLfh9hWcFlMTBp1jN2NvJlr174YI95m56l9jxWnJ2aY9QzM4w+hVBQFBkhxJFWFERMRyOJI60BDw+YMhZjy0zQTv1khvxnxQyEw2FmPU7m3RLTvvHTu8wl6qIRxf42fwGTCisRNkgzygAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse4 vector arithmetic\"\n        title=\"aegan inverse4 vector arithmetic\"\n        src=\"/vynsblog/static/f30c9d6c09b87d7095167fadabddd0df/f058b/aegan_inverse4_vector_arithmetic.png\"\n        srcset=\"/vynsblog/static/f30c9d6c09b87d7095167fadabddd0df/c26ae/aegan_inverse4_vector_arithmetic.png 158w,\n/vynsblog/static/f30c9d6c09b87d7095167fadabddd0df/6bdcf/aegan_inverse4_vector_arithmetic.png 315w,\n/vynsblog/static/f30c9d6c09b87d7095167fadabddd0df/f058b/aegan_inverse4_vector_arithmetic.png 630w,\n/vynsblog/static/f30c9d6c09b87d7095167fadabddd0df/6af66/aegan_inverse4_vector_arithmetic.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>AE-GAN version 5</h2>\n<h3>Changes from previous model (version 4)</h3>\n<h4>New loss function</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">loss_wapper</span><span class=\"token punctuation\">(</span>g_model<span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mse <span class=\"token operator\">=</span> MeanSquaredError<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    bce <span class=\"token operator\">=</span> BinaryCrossentropy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">loss</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># run data through generator</span>\n        y <span class=\"token operator\">=</span> g_model<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># calculate typical loss functions</span>\n        ae <span class=\"token operator\">=</span> mse<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n        gan <span class=\"token operator\">=</span> bce<span class=\"token punctuation\">(</span>y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span>\n\n        gan_ceil <span class=\"token operator\">=</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>ae<span class=\"token punctuation\">,</span> gan<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># record results for analysis</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"./</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">/data/alpha_beta_loss_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>MODEL_NAME<span class=\"token punctuation\">}</span></span><span class=\"token string\">.csv\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n            f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>ae<span class=\"token punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>gan<span class=\"token punctuation\">}</span></span><span class=\"token string\">\\n\"</span></span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> ae <span class=\"token operator\">+</span> gan_ceil\n\n    <span class=\"token keyword\">return</span> loss</code></pre></div>\n<h3>Results</h3>\n<h2><img src=\"/vynsblog/2772fce527669dd434c5d76a6230abb2/aegan_inverse_5_in_out.svg\" alt=\"\"></h2>\n<hr>\n<p><img src=\"/vynsblog/24316faba933b8a70d0ac982db0cb7ba/aegan_inverse5_training.gif\" alt=\"\"></p>\n<h3>Observations</h3>\n<ul>\n<li>Results are almost identical to the baseline model.</li>\n</ul>\n<h3>Data</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/6432bcc8cf4e8686dcf8f8d948bc10f9/6af66/aegan_inverse5_generator_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACQElEQVQ4y32UTWsUQRCGc/RPePNXiDcPXjwI4sWTB/EHeBICnkTFg3hSRAJ+BBRJbh4UFAU9KYpBBSW7EJZkd5Od3en57O6Z7n6ke9yZDYkZqJma6a633re6apYAnHP87zLGoLUOVlXVkXv92tJ8g9YVaZaT5zlZlrU2GAzo9Xr0+322trZIkgSlFGVZIqUMVkoZEvtrqQFTTKKIaSxC8ObmZgAYjUakadpm92atDcHBrMXWmiqLkEp3gH5TniZYmQYGQohgc5CjZGI0JhkjddUBetoeyLqDNTnc/q0tAqpqP8OiKLDGHAwOwM3NdZm6d6MOAvoiB4bWdswWGLbBVQHOgkrBVDidNQzT3Q7Qt8JsNguym5NaqFmtoZh2NSiiAERVBlCnc9h4gRn9QtaBQtM2Xm5TwwaoleaDy1knc+83lDFEfRhu4N7fhpUzmKiPrGwDOJeY+xpWMmR3MmlkeXbJDgy/w5tleHoOXl2Fx2fh/knc8jH4+gRTiqBwXw1FkmLf3cA9Oo17fhG3dhn38hLu2XncnRO4m8dxD07hVi/gPt7DfVvF/ViHbIwZfOkkeym+XcosgfUr8PY6fLgFr6/Bp7vw+SH8XIPoD5TRYY2IVTlSqYW2cSCiXcSwR6wcogKhIfZP0/hCGhJliXNFnJUkhSLOJaLQyKpGyrIBnJ+on+HJTFCUMozh3mQS5nU8HhNF0zDnO8MRIs1aP8sL4iRle3unm+V9Y+Vse6Ju7gNZmjKNIqw17bdFv67r9m/zF/hYfOq9SRXTAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse5 generator loss\"\n        title=\"aegan inverse5 generator loss\"\n        src=\"/vynsblog/static/6432bcc8cf4e8686dcf8f8d948bc10f9/f058b/aegan_inverse5_generator_loss.png\"\n        srcset=\"/vynsblog/static/6432bcc8cf4e8686dcf8f8d948bc10f9/c26ae/aegan_inverse5_generator_loss.png 158w,\n/vynsblog/static/6432bcc8cf4e8686dcf8f8d948bc10f9/6bdcf/aegan_inverse5_generator_loss.png 315w,\n/vynsblog/static/6432bcc8cf4e8686dcf8f8d948bc10f9/f058b/aegan_inverse5_generator_loss.png 630w,\n/vynsblog/static/6432bcc8cf4e8686dcf8f8d948bc10f9/6af66/aegan_inverse5_generator_loss.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/cf659f94b0058896012d25f89027e47b/6af66/aegan_inverse5_discriminator_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAB40lEQVQ4y32U6Y7aMBSFef+H6kNUI/GjJZUKAwlZve8+1XU2GOhYMknIzedzjq98yDnjf4PeOeeeZozx2/oD3aSUYIyB1nq7WmvBOcepqnA6nbbZNDWMsRBSQQoBIQSUUoVBowBp5XEcEUIoCmJMiN4heYtsxbp+UUBTaYO261FVFY7HI87nc2FsQCrS2iAFB5hp/l4PgJOA6pHnonnSiA7RcDDGMQxDEUOONiDZHCdWFEG2BZAJ5ASyHubnvCvMb7IjRgGum0K5RGcA1T0AZVG6Klxrn+A5IwS/A+mH5E6MIQX7BSi+Bxb7HpHfYayfgd57MMbgvEd0egNSdlgsr5AvPhegQ2S3HUiFtPUT47NC2QLBIsvuxfK2Kcv9Dqx34LqgNmbOkDbFSSS6Womshpfc8GT5DZCaknExt428IxFQ3EsPJtkvwPTQi5hzphfBPgPXbISUYGMPWDZbpuyCQV77khZeY0we8HqxH2ege1SYgalrUP/8AX7+gL5XsLcjTHOCayv47g/8dIVrfsGON7j+L0L7G25q4FmDMF1fFUop0Tc3GMnQtw36+w1WCbT1FWPXQPEJ9ecZgo1QgqG+XqAlB58GfF4u26FxeHfabPksgwuBrh8Q0/5vXA6DEmOI22nzD68VlOLdQEDXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse5 discriminator loss\"\n        title=\"aegan inverse5 discriminator loss\"\n        src=\"/vynsblog/static/cf659f94b0058896012d25f89027e47b/f058b/aegan_inverse5_discriminator_loss.png\"\n        srcset=\"/vynsblog/static/cf659f94b0058896012d25f89027e47b/c26ae/aegan_inverse5_discriminator_loss.png 158w,\n/vynsblog/static/cf659f94b0058896012d25f89027e47b/6bdcf/aegan_inverse5_discriminator_loss.png 315w,\n/vynsblog/static/cf659f94b0058896012d25f89027e47b/f058b/aegan_inverse5_discriminator_loss.png 630w,\n/vynsblog/static/cf659f94b0058896012d25f89027e47b/6af66/aegan_inverse5_discriminator_loss.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/6fbd6c5ab6e675aa8abc63863da079f8/6af66/aegan_inverse5_discriminator_accuracy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABp0lEQVQ4y51Ua4+bMBC8///fKkW6Dy1JE47TXVQOjA34/WAqL4VcuNBKXWkF2Mt4dnbkp2masBchRDjn4byHD2HNvT8y1tP8Y4DRGkYrWDXCyAFaDqjKMy6nAqfjD5TnE14uP3E+HcGaGkZJqHGu00ohpkSgBDgMA7gQeL0UuL6/grUfkKJBUByMzc+oOD1zupGt6UcGqyWMsTPg0rJxAcX3Z5yvDLWM0GFer5hB2leFIqUEY8yNodYKQvR4Lq8oP3qENCHERJoM2iNlxGmi723miDHeAJdFZw2+vXS4NHIVeCv4oyF8AZRSgnOOjnO8dQrShrV4y2TvkDtAIQS1PCqNXtldNns2+QLY9z0EMewhlLtj91+A6Y9/BqnApf0r4OfWd4dCltEaDevQa/dQv0d67tqGCrI9Rgm+aPiPVrOLXIiw1hLQkitDZy2altFQppToxJy5le17JqCVRNvUKIojDocDyrKEc+4GmAvHcUTXdbSRJ5/fvfdgjJGtMoO6rqnOaoVf1zeIPFAhUFUV3Qd3xt6KvgwrR3ZC27bEcon4aX9Zz7fNb+nHloq2u2jIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse5 discriminator accuracy\"\n        title=\"aegan inverse5 discriminator accuracy\"\n        src=\"/vynsblog/static/6fbd6c5ab6e675aa8abc63863da079f8/f058b/aegan_inverse5_discriminator_accuracy.png\"\n        srcset=\"/vynsblog/static/6fbd6c5ab6e675aa8abc63863da079f8/c26ae/aegan_inverse5_discriminator_accuracy.png 158w,\n/vynsblog/static/6fbd6c5ab6e675aa8abc63863da079f8/6bdcf/aegan_inverse5_discriminator_accuracy.png 315w,\n/vynsblog/static/6fbd6c5ab6e675aa8abc63863da079f8/f058b/aegan_inverse5_discriminator_accuracy.png 630w,\n/vynsblog/static/6fbd6c5ab6e675aa8abc63863da079f8/6af66/aegan_inverse5_discriminator_accuracy.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Vector Arithmetic</h3>\n<p><strong>Top row</strong>: smiling women (last column is average latent vector output)</p>\n<p><strong>Middle row</strong>: neutral women</p>\n<p><strong>Bottom row</strong>: neutral men</p>\n<p><strong>Last image</strong>: smiling women - neutral women + neutral man\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/42d867023cda0db3b80c6032dd382e28/6af66/aegan_inverse5_vector_arithmetic.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACsklEQVQ4y52USU9TYRSG+Qv+E01cuDWuXBg3JmCIJhjBhSHBjYxRonFiDjMBClKKaGuFFopQplagTaG1ZSpDo4AWy1Q0Bmh7h8fcWysaSIiczXffc899cs77fd9NApBlmRPjhJoEIynxsLd/wLTXzdfFWXY2Q0iyTDDgJ7wa4Ed4C6Vqd2Od/e0N9n5+R5QkVpcXCX/5RHgz9AeaJMuSKr4F1zAUF+Cofcz0UA8HkQjNman05qbjt1lUoLWpHFdLBdOjfUQFEf2zHMYrC5g0d8aBknTYYTgUZL6jiuVXjbj7u4kJMRrupNCddZuAfQAR6Kspxl7xgjmblZgo8r68kMnKR3h63hwDDO9gf63BZdQxZrep7X/oasdneU1gzqt2OGTUYu1oxjVhj+u3WlxdWsaGrUeBWxsbmEof8OzmVV5pNMprBhry6K/NYsZuQpCgMz+Z3sIrtFUXqd8YS+5hKEylvSauJUkkSaEqEQwGachMozLlMl1tLWrOWpfNuCaHhfFu9qMS9ekX6U4/i7WlhKgEbflp9GRfw6IpO2bk3TCuQRMesxbflFPNzY/ombM0E1zyEJNgRFeNs/U5toFedWSHWYv3XT3OYctR4N7PMF5zFbqH13EP6ZUB2DTkstKUgd/SrtZs99cz9TQNS2OJqtfMRXysuMnoy9LfQPFfoKEog+RzZzB31CILAjPFKdgzL2CsiwOmO4tx3L3ESMMTFKPcmvt03jpPR1Fe3EPxL2AsFmV5xsGg6Q2fAwsIgsj8qIXFQSM+rw9RBv/kBOuuYVb9PiKCiLNHx4ypiYnh/sORT3v1ogf7BPta2TKUEXLEDz7yXx4qq7LtoiggSVJciyJSQv8+FkpOBUYOWNJXY8u9wVBz2aGH/GckGohEoyx6nKy4x5j1eg7vMqeI4yxK/G1+Aa37K6yqh/UIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aegan inverse5 vector arithmetic\"\n        title=\"aegan inverse5 vector arithmetic\"\n        src=\"/vynsblog/static/42d867023cda0db3b80c6032dd382e28/f058b/aegan_inverse5_vector_arithmetic.png\"\n        srcset=\"/vynsblog/static/42d867023cda0db3b80c6032dd382e28/c26ae/aegan_inverse5_vector_arithmetic.png 158w,\n/vynsblog/static/42d867023cda0db3b80c6032dd382e28/6bdcf/aegan_inverse5_vector_arithmetic.png 315w,\n/vynsblog/static/42d867023cda0db3b80c6032dd382e28/f058b/aegan_inverse5_vector_arithmetic.png 630w,\n/vynsblog/static/42d867023cda0db3b80c6032dd382e28/6af66/aegan_inverse5_vector_arithmetic.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Metrics</h2>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Metric</th>\n<th align=\"center\">Baseline</th>\n<th align=\"center\">AE-GAN version 1</th>\n<th align=\"center\">AE-GAN version 4</th>\n<th align=\"center\">AE-GAN version 5</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">Blur factor (dataset raw = 658.269)</td>\n<td align=\"center\">112.923</td>\n<td align=\"center\">102.538</td>\n<td align=\"center\">232.115</td>\n<td align=\"center\">114.730</td>\n</tr>\n<tr>\n<td align=\"left\">Discriminator loss real</td>\n<td align=\"center\">1.0542e-12</td>\n<td align=\"center\">4.697e-10</td>\n<td align=\"center\">2.069e-8</td>\n<td align=\"center\">1.316e-12</td>\n</tr>\n<tr>\n<td align=\"left\">Discriminator loss fake</td>\n<td align=\"center\">1.308e-9</td>\n<td align=\"center\">0.0</td>\n<td align=\"center\">0.0</td>\n<td align=\"center\">1.959e-10</td>\n</tr>\n<tr>\n<td align=\"left\">Discriminator accuracy real</td>\n<td align=\"center\">100%</td>\n<td align=\"center\">99.650%</td>\n<td align=\"center\">97.800%</td>\n<td align=\"center\">99.870%</td>\n</tr>\n<tr>\n<td align=\"left\">Discriminator accuracy fake</td>\n<td align=\"center\">99.950%</td>\n<td align=\"center\">99.880%</td>\n<td align=\"center\">99.800%</td>\n<td align=\"center\">99.990%</td>\n</tr>\n<tr>\n<td align=\"left\">Generator loss</td>\n<td align=\"center\">0.694</td>\n<td align=\"center\">0.017</td>\n<td align=\"center\">0.017</td>\n<td align=\"center\">0.707</td>\n</tr>\n<tr>\n<td align=\"left\">Complexity (trainable/non-trainable)</td>\n<td align=\"center\">3,222,587 / 1,651,841</td>\n<td align=\"center\">3,222,587 / 1,651,841</td>\n<td align=\"center\">3,222,587 / 1,651,841</td>\n<td align=\"center\">3,222,587 / 1,651,841</td>\n</tr>\n<tr>\n<td align=\"left\">Latent space nodes</td>\n<td align=\"center\">100</td>\n<td align=\"center\">100</td>\n<td align=\"center\">100</td>\n<td align=\"center\">100</td>\n</tr>\n</tbody>\n</table>\n<h2>Conclusions</h2>","frontmatter":{"title":"AE-GAN Optimizations","date":"April 20, 2022","description":""}},"previous":{"fields":{"slug":"/wk-14-vae-gan/"},"frontmatter":{"title":"AE GAN Experiments"}},"next":{"fields":{"slug":"/vae-gan-experiments/"},"frontmatter":{"title":"VAE-GAN Experiments II"}}},"pageContext":{"id":"671efa06-3184-59a1-ad9f-a7f3ec9a6fec","previousPostId":"8eee15d1-f4d9-5002-9820-a5011357babb","nextPostId":"9ece1428-eb79-5111-9e31-e3d33e1cbf00"}},"staticQueryHashes":["2841359383"]}