{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/wk-7-reduce-blury-vae/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Vyn's Blog"}},"markdownRemark":{"id":"0fd37f52-a717-515f-9bfd-187a39a0e0ca","excerpt":"This week, I first began testing smaller latent spaces on the standard VAE\narchitecture from last week. I then made several attempts at training a standard…","html":"<p>This week, I first began testing smaller latent spaces on the standard VAE\narchitecture from last week. I then made several attempts at training a standard\nautoencoder to only reconstruct images from the dataset in hopes they would be\nable to reduce the blury output from the VAE.</p>\n<h2>Results of smaller latent spaces using standard VAE</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/c608770eabe509ad74e0cc6f9cdc6cd6/212bf/blury_test.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.9746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAECAwQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAerCsXSNCgZAf//EABsQAAIDAAMAAAAAAAAAAAAAAAESABETAiFB/9oACAEBAAEFAsxMhMuN0ZXXrGMVYt//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAACAgMBAQAAAAAAAAAAAAAAATFBIVGRAjL/2gAIAQEABj8CrhUaK4QrsjzGx4XSXLJfyPLP/8QAIBAAAgEDBAMAAAAAAAAAAAAAAAERYXGRITFBUYGxwf/aAAgBAQABPyF5z4DhViYDcz9BcZ8g2tI2nfLGqswP6oOq3dD/2gAMAwEAAgADAAAAEJ8wQ//EABYRAAMAAAAAAAAAAAAAAAAAAAERIP/aAAgBAwEBPxBCP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EACAQAAICAgICAwAAAAAAAAAAAAERADFBYSFRcaGBkeH/2gAIAQEAAT8QDAKNGXdj4i5f2PmcRrNV8CJAFJYO2a/RuHoFEQD0GxVb+xEWOa+qCsQe/FPDHLc0QZdJ/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"input output vae different number of latent variables\"\n        title=\"input output vae different number of latent variables\"\n        src=\"/vynsblog/static/c608770eabe509ad74e0cc6f9cdc6cd6/828fb/blury_test.jpg\"\n        srcset=\"/vynsblog/static/c608770eabe509ad74e0cc6f9cdc6cd6/ff44c/blury_test.jpg 158w,\n/vynsblog/static/c608770eabe509ad74e0cc6f9cdc6cd6/a6688/blury_test.jpg 315w,\n/vynsblog/static/c608770eabe509ad74e0cc6f9cdc6cd6/828fb/blury_test.jpg 630w,\n/vynsblog/static/c608770eabe509ad74e0cc6f9cdc6cd6/212bf/blury_test.jpg 768w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Images appear to lose definition with smaller latent spaces.</li>\n<li>Interestingly, color changes as well.</li>\n<li>The shirt pattern seems to disappear entirely.</li>\n<li>However, interpolations seem to be much more drastic with fewer latent variables suggesting benefit of using fewer latent variables.</li>\n</ul>\n<h2>Training a normal autoencoder to reconstruct the images</h2>\n<h4>Version 1:</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_1 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>     <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">1792</span>\n_________________________________________________________________\nmax_pooling2d <span class=\"token punctuation\">(</span>MaxPooling2D<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_1 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">18464</span>\n_________________________________________________________________\nmax_pooling2d_1 <span class=\"token punctuation\">(</span>MaxPooling2 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose <span class=\"token punctuation\">(</span>Conv2DTran <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">9248</span>\n_________________________________________________________________\nup_sampling2d <span class=\"token punctuation\">(</span>UpSampling2D<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose_1 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">18496</span>\n_________________________________________________________________\nup_sampling2d_1 <span class=\"token punctuation\">(</span>UpSampling2 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>      <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_2 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1731</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">731</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">731</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n_________________________________________________________________</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/205cb88124b3b118a0182baef1b97566/f569a/convAE_v1_inout.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 248.1012658227848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAyABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwT/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAAB6Z7oLgdhta0qN0EybwVFjUgHQJ//xAAcEAADAQEBAAMAAAAAAAAAAAABAgMAERITMzT/2gAIAQEAAQUCpKAZ4RC/BEhpqT5DZhzMyqxIVWIOZCbUUnMOYpZKOlCx9ah47niN06n6L/S2/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEg/9oACAEDAQE/AQq//8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEg/9oACAECAQE/AQ6//8QAIxAAAgIBAwMFAAAAAAAAAAAAAAECETEDIVESQXETIiMyYf/aAAgBAQAGPwJfGqWRr01kTWmi2O+RJCTyyTlyJrFG6tG3IkuByi+pPs+x1acsP6nvVP8ACNZJb1uK80aZLyLwf//EAB0QAAMAAwADAQAAAAAAAAAAAAABESExQRBRsWH/2gAIAQEAAT8hS34LoglG0fojAqKsY1aSMJ5CRvlYjTEmNwGpFDpWI8bHoqREtBFvvQrSPJWGM0gJqbPKTgitsmUMh9mR9/j/AJj/2gAMAwEAAgADAAAAEPsMTL8IPP/EABgRAAMBAQAAAAAAAAAAAAAAAAEQMREh/9oACAEDAQE/EOqgFiFC/8QAGBEBAQEBAQAAAAAAAAAAAAAAARAxESH/2gAIAQIBAT8Qj4Wd2OM//8QAIBABAQACAgICAwAAAAAAAAAAAREAITFBYXFR8KGxwf/aAAgBAQABPxDcjNB2P5bgDJBG4mIe2wR5qP6yQZWykyow2hnxlsLoq27cXgKqd9XAz3mivXGMtAkOEbguxaPAhr85YrqR5DI+lAODnK2xbAXUPWsWq1SNotcDcpsVJWZU0c3YTdMV9gCREneCOAUHF3n3veff8mcM3//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"input output ae version 1\"\n        title=\"input output ae version 1\"\n        src=\"/vynsblog/static/205cb88124b3b118a0182baef1b97566/f569a/convAE_v1_inout.jpg\"\n        srcset=\"/vynsblog/static/205cb88124b3b118a0182baef1b97566/ff44c/convAE_v1_inout.jpg 158w,\n/vynsblog/static/205cb88124b3b118a0182baef1b97566/f569a/convAE_v1_inout.jpg 266w\"\n        sizes=\"(max-width: 266px) 100vw, 266px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>I think max pooling and upsampling is causing the loss in resolution</li>\n<li>Try next version without that, just convolutional layers</li>\n<li>Also add batch normalization layer</li>\n</ul>\n<blockquote>\n<p>Training deep neural networks with tens of layers is challenging as they can be sensitive to the initial random weights and configuration of the learning algorithm</p>\n</blockquote>\n<ul>\n<li>Batch normalization helps to standardize inputs to a layer which stabalizes the learning process and should be used for deep neural networks.</li>\n</ul>\n<h2>Note on Calculating Output Image Size For Convolutional Layers</h2>\n<ul>\n<li>Kernal convolves accross input image</li>\n<li>Filters are last dimension</li>\n<li>Stride of 2 will reduce height and width of input image by half on conv2d layer and double it for cont2d_transpose layer</li>\n</ul>\n<p>Here is the formal formula.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">output_height <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>input_height <span class=\"token operator\">+</span> padding_height_top <span class=\"token operator\">+</span> padding_height_bottom <span class=\"token operator\">-</span> kernel_height<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>stride_height<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\noutput_width <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>input_width <span class=\"token operator\">+</span> padding_width_right <span class=\"token operator\">+</span> padding_width_left <span class=\"token operator\">-</span> kernel_width<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>stride_width<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span></code></pre></div>\n<h4>Version 2:</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_1 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>     <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">3584</span>\n_________________________________________________________________\nconv2d_1 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">147584</span>\n_________________________________________________________________\nconv2d_2 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295168</span>\n_________________________________________________________________\nbatch_normalization <span class=\"token punctuation\">(</span>BatchNo <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1024</span>\n_________________________________________________________________\nconv2d_transpose <span class=\"token punctuation\">(</span>Conv2DTran <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295040</span>\n_________________________________________________________________\nconv2d_transpose_1 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">73792</span>\n_________________________________________________________________\nconv2d_transpose_2 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1731</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">817</span><span class=\"token punctuation\">,</span><span class=\"token number\">923</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">817</span><span class=\"token punctuation\">,</span><span class=\"token number\">411</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">512</span>\n_________________________________________________________________</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/db2def843a8c78354012077833a7196d/f569a/convAE_v2_inout.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 248.1012658227848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAyABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEAQP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABp25YhKw7KiK5gnPKFFNBVCXoBZ//xAAeEAADAQEAAQUAAAAAAAAAAAABAgMAERIEEyIzNP/aAAgBAQABBQKkoBnhEL7MSGmpPiGzDxzMqsWCq57mQm1ATmHMUslHShb5ah47niN3U/R6j6W3/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEg/9oACAEDAQE/AQq//8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAgEBPwEP/8QAIxABAAEDAwMFAAAAAAAAAAAAAQACETEDElEhQXEiIzJhcv/aAAgBAQAGPwI9ssZibDME0yXY35gEByypq5gmLTqXJ05gHEaqXcPZ7Tfp1YfjPWA/UptmVeYX4mnKv1DxP//EAB4QAQACAwACAwAAAAAAAAAAAAEAESExQRBRYXGx/9oACAEBAAE/IRb4F2AS5VPqVwBJaxjmiUoPACb5WiaMhQNgrEsOlYPjdO4VZQaEC33sH6DmthisMRhRpyquQLamWSJD2cp+/wANr9c//9oADAMBAAIAAwAAABCwCU30H7z/xAAYEQADAQEAAAAAAAAAAAAAAAABECERQf/aAAgBAwEBPxCoUFiHF//EABcRAQEBAQAAAAAAAAAAAAAAAAEQIUH/2gAIAQIBAT8QYuMWPZ//xAAhEAEBAAMAAgAHAAAAAAAAAAABEQAhMUFxEGGRobHB8P/aAAgBAQABPxDcjNB5H6twhsgjYJju/ib6KP4yQZWykwyQ2h9Za9lPq4vAVU8+LgTbzRXxzE2gSHEbguxaPBDX3y4WWD5hk5Sg4HcpbFsBeIetY0FgSNotcZehCpKzKmjt2E3TGOKgsaSbwlwKg5d5/d7+JE//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"input output ae version 1\"\n        title=\"input output ae version 1\"\n        src=\"/vynsblog/static/db2def843a8c78354012077833a7196d/f569a/convAE_v2_inout.jpg\"\n        srcset=\"/vynsblog/static/db2def843a8c78354012077833a7196d/ff44c/convAE_v2_inout.jpg 158w,\n/vynsblog/static/db2def843a8c78354012077833a7196d/f569a/convAE_v2_inout.jpg 266w\"\n        sizes=\"(max-width: 266px) 100vw, 266px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Images seem to have more definition</li>\n<li>Interesting to note: background color changes on pretty much all output images.</li>\n</ul>\n<h2>Measuring the blur of an image</h2>\n<ul>\n<li>Fast Fourier Transform is an option, examine the distribution of low and high frequencies.</li>\n<li>Another option is variance of the Laplacian. I chose this option because it’s simpler, but it may be less accurate than the Fourier method (see demo).</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">laplacian_kernel <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>The blur factor is calculated by convolving the laplacian kernel over the image and taking the variance of the new image.</li>\n<li>The laplacian kernel is essentially edge detection (it approximates the 2nd derivative of the image).</li>\n<li>Blurry images have fewer edges.</li>\n<li>Non blurry images have very well defined edges.</li>\n<li>This computation is used in the GUI demo.</li>\n</ul>\n<h2>Connecting VAE output to input of standard autoencoder V2</h2>\n<p>This experiment was done using the previously used VAE architecture (256 latent variables) and the AE version 2. Images were first run though VAE, then output of VAE becomes input to AE.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/99a6391a7a61bc3c51b791cc3ef85728/c8a40/vae_ae.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.88607594936708%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgAB/9oADAMBAAIQAxAAAAHTEOkxv//EABgQAAMBAQAAAAAAAAAAAAAAAAACEhAB/9oACAEBAAEFApQlCEzuf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/AWf/xAAZEAEAAwEBAAAAAAAAAAAAAAAAQZHhATH/2gAIAQEABj8CYxNpt71//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAEhQRFhkYH/2gAIAQEAAT8hcvtD0jQHjDm/DEUzcK8dD//aAAwDAQACAAMAAAAQoD//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QEX//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/EB//xAAeEAEAAQUBAAMAAAAAAAAAAAABEQAhMUFRoXGx8P/aAAgBAQABPxCNcRwcTfXbUJZBmbLd1qhMXEDAtb45FEJiPoPfzUsMRFjiF9xUx2Is7IPK/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Images run through VAE then AE\"\n        title=\"Images run through VAE then AE\"\n        src=\"/vynsblog/static/99a6391a7a61bc3c51b791cc3ef85728/828fb/vae_ae.jpg\"\n        srcset=\"/vynsblog/static/99a6391a7a61bc3c51b791cc3ef85728/ff44c/vae_ae.jpg 158w,\n/vynsblog/static/99a6391a7a61bc3c51b791cc3ef85728/a6688/vae_ae.jpg 315w,\n/vynsblog/static/99a6391a7a61bc3c51b791cc3ef85728/828fb/vae_ae.jpg 630w,\n/vynsblog/static/99a6391a7a61bc3c51b791cc3ef85728/c8a40/vae_ae.jpg 931w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Background color change seems to get worse as it’s run through the ae multiple times.</li>\n<li>Running output of VAE through AE doesn’t seem to help image blur much.</li>\n</ul>\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://machinelearningmastery.com/batch-normalization-for-training-of-deep-neural-networks/\">https://machinelearningmastery.com/batch-normalization-for-training-of-deep-neural-networks/</a></li>\n<li><a href=\"https://pyimagesearch.com/2015/09/07/blur-detection-with-opencv/\">https://pyimagesearch.com/2015/09/07/blur-detection-with-opencv/</a></li>\n<li>J. L. Pech-Pacheco, G. Cristobal, J. Chamorro-Martinez and J. Fernandez-Valdivia, “Diatom autofocusing in brightfield microscopy: a comparative study,” Proceedings 15th International Conference on Pattern Recognition. ICPR-2000, 2000, pp. 314-317 vol.3, doi: 10.1109/ICPR.2000.903548.</li>\n</ul>","frontmatter":{"title":"VAE Experiments for Reducing Blury Decoder Output","date":"February 12, 2022","description":"This is a custom description for SEO and Open Graph purposes, rather than the default generated excerpt. Simply add a description field to the frontmatter."}},"previous":{"fields":{"slug":"/hello-world/"},"frontmatter":{"title":"Hello World"}},"next":{"fields":{"slug":"/wk-8-vector-arithmetic/"},"frontmatter":{"title":"Vector Arithmetic with VAE"}}},"pageContext":{"id":"0fd37f52-a717-515f-9bfd-187a39a0e0ca","previousPostId":"51194a13-cb41-5cb5-a018-70b95bf41f03","nextPostId":"18f1d2b0-e9ff-5e51-8bff-032bf898468c"}},
    "staticQueryHashes": ["2841359383"]}