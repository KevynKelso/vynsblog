{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/wk-8-vector-arithmetic/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Vyn's Blog"}},"markdownRemark":{"id":"18f1d2b0-e9ff-5e51-8bff-032bf898468c","excerpt":"Building an accordion AE to retry experiment from last week Accordion V1  Blocking effect seems to be happening. After testing new architecture, it does notâ€¦","html":"<h2>Building an accordion AE to retry experiment from last week</h2>\n<h3>Accordion V1</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_1 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>     <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">3584</span>\n_________________________________________________________________\nconv2d_1 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">147584</span>\n_________________________________________________________________\nconv2d_2 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295168</span>\n_________________________________________________________________\nbatch_normalization <span class=\"token punctuation\">(</span>BatchNo <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1024</span>\n_________________________________________________________________\nconv2d_transpose <span class=\"token punctuation\">(</span>Conv2DTran <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295040</span>\n_________________________________________________________________\nconv2d_transpose_1 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">73792</span>\n_________________________________________________________________\nconv2d_transpose_2 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1731</span>\n_________________________________________________________________\nconv2d_3 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">3584</span>\n_________________________________________________________________\nconv2d_4 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">147584</span>\n_________________________________________________________________\nconv2d_5 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295168</span>\n_________________________________________________________________\nbatch_normalization_1 <span class=\"token punctuation\">(</span>Batch <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1024</span>\n_________________________________________________________________\nconv2d_transpose_3 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295040</span>\n_________________________________________________________________\nconv2d_transpose_4 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">73792</span>\n_________________________________________________________________\nconv2d_transpose_5 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1731</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">635</span><span class=\"token punctuation\">,</span><span class=\"token number\">846</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">634</span><span class=\"token punctuation\">,</span><span class=\"token number\">822</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">024</span>\n_________________________________________________________________</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/f569a/convAE_accordion_v1_inout.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 248.1012658227848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAyABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIEAwH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAdLfJYWtXaJibCcvNElL00yZeg0f/8QAHRAAAwEBAAIDAAAAAAAAAAAAAQIDABEEEyIzNP/aAAgBAQABBQKkoBnjEL6YsGmpJQNiAuZlViVVW4cyE2qpOYcxSyUolC3y1Dx3PEPTqfo8j6W3/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBEg/9oACAEDAQE/AQq//8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAgEBPwEP/8QAIhABAAEDAwQDAAAAAAAAAAAAAQACETEDElEhQWFxIiMy/9oACAEBAAY/Aj6yxmJsMwTTJdjfmAQHLKmrmCYtOpcnTmB4jVS7h7Pab9OrD+Z8wHxKbZlXuF82mnKvcPU//8QAHhABAAIDAAIDAAAAAAAAAAAAAQARITFBEFFhcbH/2gAIAQEAAT8hFvgXYZLlU+pWgslrGZESlOYAm+VomsIUdgtWJYdKwPG6dwKxQaEC33sD6DkthisJEo05VXJuaZZIwezKfv8AD6fXP//aAAwDAQACAAMAAAAQ4CxA5A+8/8QAGBEAAwEBAAAAAAAAAAAAAAAAARARITH/2gAIAQMBAT8Q1RQFEOhf/8QAFxEBAQEBAAAAAAAAAAAAAAAAARAhMf/aAAgBAgEBPxDYuMXseM//xAAhEAEBAAICAgEFAAAAAAAAAAABEQAhMUFhcRBRobHB8P/aAAgBAQABPxDcjNB2P1bhLZBGwTJH2wjyKP4yQZWykwJGbQz6YQ+6rfLi8BVTvq5yp5or1xjpQSHCNwXYtHgQ198p11I8hho5QcBzlbYtgLqHrWJBaEjaLXGWA2KkrMqaObsJumG53QWOp3hngFBxd5/d7+Vp/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Accordion AE input/output\"\n        title=\"Accordion AE input/output\"\n        src=\"/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/f569a/convAE_accordion_v1_inout.jpg\"\n        srcset=\"/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/ff44c/convAE_accordion_v1_inout.jpg 158w,\n/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/f569a/convAE_accordion_v1_inout.jpg 266w\"\n        sizes=\"(max-width: 266px) 100vw, 266px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Blocking effect seems to be happening.</li>\n<li>After testing new architecture, it does not seem to help much with reducing blury output.</li>\n</ul>\n<h2>Using CelebA dataset for vector arithmetic</h2>\n<h3>Dataset sample</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/71ee9/celeb_dataset.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.92405063291139%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACZklEQVQ4y32T21NSURTG/bd69qWml15Lm+nFnBrGGWdqrDTxEiaimYSCkx4RL2kBAypqIk40eEkuBpoyxahFygh5UkGu5/B1XMcLKNN6+q359v5mr7XXKoIQ2WwWZ5HLQobcyGb5c+Z5Pu/O2b2iM4ge/sVOcJt4l03A5t1BMgNwmTSc83NgIyHSZmdnsLy8RMz+CSH0+0eecRHPcZRYjSOQPiwjnloMoLyiGWwSiB9GICu7iSW7lbSn90ugeP6Y2Pv5A6za6kuGp093LtjR39VOvL7hh7JNjqPYMaKJNCaHurGztkiapf8NPhoHiUPBADb97ryyzw0NvR3QKZ4R+1fn0SC5DnY/jEwqDmfbbUR90zippedJKTS1Ejr3dXkRlnf95/3OMxw36qEfFMVvqx5USu6BZVkh4xBwTWN/L0haS1M9VKoOYrfDDlMfc7lksYcjajlqHtwhHjObUHqjGJFwGIlUBq+rX8Ll9JHWLJei562S2GWbB/NCA77gC0e1ULXUEq95PWDa5TiOJxAX+sjImuD74iRNr9VgzvxeNFxYQfsrBlwhQ6arDpWPSoiDwRAaKu7iILKLg6MotG1V2PruFQ1rqmBuaST22G0YkJYLo8VdlJw9NVxxmDE6rCb+ub2FqeEucMkYoscxGDrr4HOLs2fo68aEXid+im0KE52NSKfSVw29LjccE0bizVU3fFYTcSaVFPrbirX1Dcp1owNoba0nVipkuFV8Dcl05qrhuHkMvUpxDveDm9j6ZDk5gZRgODOkQeiXuEXD3Wo4pieJ5ywmMIqGS4YiFdzl3N39/85f5P8A+zOdZgcKeCUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CelebA dataset sample\"\n        title=\"CelebA dataset sample\"\n        src=\"/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/f058b/celeb_dataset.png\"\n        srcset=\"/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/c26ae/celeb_dataset.png 158w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/6bdcf/celeb_dataset.png 315w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/f058b/celeb_dataset.png 630w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/40601/celeb_dataset.png 945w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/71ee9/celeb_dataset.png 1081w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Preprocessing</h3>\n<p>To increase model performance, only the faces in each image were extracted using a pre-trained Multi-Task Cascaded Convolutional Neural Network (MTCNN).\nBelow are the same faces as above, but only the face extracted.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/6af66/celeba_extracted.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAADK0lEQVQ4y62U60+bZRjG+ZdMpsk++E3/AE00M34hGpfMqVTRhKmZWZgOxyE4GGTCOspBIB3U1YZ1TCllbQVKaWkppQdaenp7oPTAu76lXdufL4OuJnzU+9PzfPk995Xrup4W5KnX6/zXaTBaGodSqUQy5Cfk91GuVDhKRigdRCmXjymk4xRT+7wol4jHYwTddo5yh5SPJdIRL4XD1CtoS61We3kJB3xMftVK92cfkz7IMNv+Id57HRSPcngf3cV8+xPiIS/OZT3L3R3srRqJeTd53HuZde3IGbDWBIZCIdS3vmd+sIfDgsj4jW/ZHL+DKB0TMM6xMvojqVSCfZsZx+Qw29ZVcskQazM9BKz65ob1M6AQDqLr/o6N+XFZfpEd4wxP718nd5jG/YcSr+YXCpkkBY+R0MSXCHYDqXgcm/qBDHx2XnI06GO67SNsY0PUqmUeDX6D4p0L5LNpvNM9RLW91MsiiWdqTIqLWH6fIr4fZLHvJo4nOuqnxBNTToHpRIy/xnp5qlZReF7Et6pnYWyQTDZHwWUmppsgn0wi7O3gXnyIz7NNNhFha05F0Go6v2Fg24H6ygUmO94jL0qYfu1k6aaCfD7P7oN+7r11kV2rnX23GdPELcIeKwmPk8UvLuFUj503JRwOo+m7hmFqCKlcwaKdwfibElEsEljSYxjoRojE8LusbMwNEwu4OYhHccyOyGpM1BqSG0Ah6uda6+uM/HSZyosqD4c7Ge14l1z2AJd2FMtAG4WswN7KE6xdV0nYjCT9TtLLd8g6dJzG+V8uZwQfg1dfY7r/CsdysJWdnzP1wweI+Qz22busyg9lE3JMFjTMK94ntGZA8DoQdLdJr2upvgKeNSWbErDrVLiWNEiSxN8aFV6jnooM9xi1bKmHEDMJzMsGutoV2KybRAO7mFR9ctgXmi43JMfk2s1d/5THAzcoSUUcyi4MP3+NVHzO+kQP2vZLpMJ7qEeGaXvzDbYtFnY2zNxvfRuDsr9pSmPDEzfdlhWCzk2q1SpiLIgY9r2MQi7iI7q1RlEqEZG7LmytU5NEuddxPOY/CXpczQ3/r9/mBHZC+QebCBjc0kT7WAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CelebA extracted faces\"\n        title=\"CelebA extracted faces\"\n        src=\"/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/f058b/celeba_extracted.png\"\n        srcset=\"/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/c26ae/celeba_extracted.png 158w,\n/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/6bdcf/celeba_extracted.png 315w,\n/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/f058b/celeba_extracted.png 630w,\n/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/6af66/celeba_extracted.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>VAE Model for vector arithmetic</h2>\n<p>Note: The model from the article is a GAN, I chose to use a VAE to keep our experiments more consistent with the â€˜autoencoderâ€™ structure.</p>\n<h3>VAE Version 1</h3>\n<h4>Encoder</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model\"</span>\n__________________________________________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                    Output Shape         Param <span class=\"token comment\">#     Connected to</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\ninput_1 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token number\">0</span>\n__________________________________________________________________________________________________\nconv2d <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>                 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>  <span class=\"token number\">3584</span>        input_1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nconv2d_1 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>   <span class=\"token number\">73792</span>       conv2d<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nconv2d_2 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>   <span class=\"token number\">18464</span>       conv2d_1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nconv2d_3 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>     <span class=\"token number\">4624</span>        conv2d_2<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nbatch_normalization <span class=\"token punctuation\">(</span>BatchNorma <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>     <span class=\"token number\">64</span>          conv2d_3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nflatten <span class=\"token punctuation\">(</span>Flatten<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>           batch_normalization<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\ndense <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>                   <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">102656</span>      flatten<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\ndense_1 <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>                 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">102656</span>      flatten<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\n<span class=\"token keyword\">lambda</span> <span class=\"token punctuation\">(</span>Lambda<span class=\"token punctuation\">)</span>                 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>           dense<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n                                                                 dense_1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">305</span><span class=\"token punctuation\">,</span><span class=\"token number\">840</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">305</span><span class=\"token punctuation\">,</span><span class=\"token number\">808</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">32</span></code></pre></div>\n<h4>Decoder</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model_1\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_2 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>             <span class=\"token number\">0</span>\n_________________________________________________________________\nintermediate_decoder <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>               <span class=\"token number\">102800</span>\n_________________________________________________________________\nreshape <span class=\"token punctuation\">(</span>Reshape<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose <span class=\"token punctuation\">(</span>Conv2DTran <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">4640</span>\n_________________________________________________________________\nconv2d_transpose_1 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">18496</span>\n_________________________________________________________________\nconv2d_transpose_2 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">73856</span>\n_________________________________________________________________\nconv2d_transpose_3 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>         <span class=\"token number\">3459</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">203</span><span class=\"token punctuation\">,</span><span class=\"token number\">251</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">203</span><span class=\"token punctuation\">,</span><span class=\"token number\">251</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></code></pre></div>\n<h2>VAE Reconstruction results</h2>\n<p>The result here is better than I expected for a VAE of this size, output was expected to be blurry, but one can make out who the face is. It might be worth using a GAN for future experiments as thatâ€™s what was used in the article.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f00413ed41a35814e7263688d80f8217/6af66/conv_vae_v1_results.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAADKElEQVQ4y62U20/aZxzG/XuWmSy72eWS3TZZmvVqS9t0W9bMxtYak61ZtriDB1zaTZZU2VQwrS3iYWir00jFAyCiYhUFOSP4+wFCOQpYKPDZr63UJe5u+169780n3+d9nuetQ5pqtcp/nRqjrnY4LhQI+1343U6KpRKZSJB8LESx+JxMTCAXDVAqHiMKAt6dTbLJBMXjAodBJ+ln0TfQukql8uoS9LgYbPqEji8vEovHedB8gZ27TeQzSex/ytF3XEbw7bGl/4vZzpu4zXoOXJtMdF7GpO05AVZOgQG/D3XbV4zKO0lkjlD90IJ58DZH0uZOvYYnva1EoyL+DQOWe3JslhWSkQCGe524VqZPN6yeAMNBPxOyr7GMKjmWpNjmh5jqvUUqEWN7sg/b6G1JWoS0fRFX/3UE6zxRUWBV04fLsnhWsuBzMXT9IhaVnHK5yJi8mcZzb5NOxnA8lOEdkfHiOIO4PMLCtXcxaO8jBHxM3WnFOjtZc+alKa+Bh2GBuX4Zs+oBMkd59kwzTA508yyZImUz4H+kJBkNI/rsbM6pce7tkAiHsI4N4LEsnd3Qu7uJ+tN6VDc/JCUBF3tamfnxGul0GofyDr998A6OtQ0CuyZ0qu/x7a4SdtiYbvyIp5r+s6YEg/toulrQSQ9eKJYwaoeYH1KQzeVw66fRdXcgBkO4bRbMw3JCbhsxIcT6AwVO8xLVmuQaUAy6afm4nt6frlB8UWa451sUzeckU+JsTShY6m4gHRfxLs9gar+KuDZPxLtNSPcrh1YtldfEU5fjBx7kn73F/a7PeS4F+4/WqwzeukA2FWdDLWe57QoJ0Yd5ahxN43l85ieI7i382naE1fF/AE+akjwMsz6hZGtunEIhj3FsEPvCY0qlIna9FqskMxsPY9TrabvRwMbaOiGPg0VlF9v6R/8i2e9m+JsvePzLd1INc6z1tTHbfoNCPodZJWO06TyRfQ8jv9+l4b16to1L2NeNKC69j67/51NTahumUylspgW8NquUwzKZAy/pfeerKCSDLvafrpCTWvOyouLWKuV8FlEUsRvm8Eluv4nN//3b/A2Z7hJ+9LindwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Convolutional VAE V1 Reconstruction Results\"\n        title=\"Convolutional VAE V1 Reconstruction Results\"\n        src=\"/vynsblog/static/f00413ed41a35814e7263688d80f8217/f058b/conv_vae_v1_results.png\"\n        srcset=\"/vynsblog/static/f00413ed41a35814e7263688d80f8217/c26ae/conv_vae_v1_results.png 158w,\n/vynsblog/static/f00413ed41a35814e7263688d80f8217/6bdcf/conv_vae_v1_results.png 315w,\n/vynsblog/static/f00413ed41a35814e7263688d80f8217/f058b/conv_vae_v1_results.png 630w,\n/vynsblog/static/f00413ed41a35814e7263688d80f8217/6af66/conv_vae_v1_results.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Vector Arithmetic process</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/87315/vector_arithmetic_process.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 139.24050632911394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAcABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAe6uhEcWguRUUZ//xAAcEAABBAMBAAAAAAAAAAAAAAAAAQIQEQMiMUH/2gAIAQEAAQUCjePVZZwXhkS2tKP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAVEAEBAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwI1/wD/xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMUFxEFGR/9oACAEBAAE/Ibcxuit9S7uq4hle4h7FECmWoGS1GW58YFm8bu37P//aAAwDAQACAAMAAAAQJ8m//8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEREDH/2gAIAQMBAT8Q4ykquf/EABgRAAMBAQAAAAAAAAAAAAAAAAABERAx/9oACAECAQE/EFwiLn//xAAdEAEAAwADAQEBAAAAAAAAAAABABEhMUFRgWHh/9oACAEBAAE/ECjbj5AGDy8Mo3079fYaP1sUB0C7zY8kaBj5LjaLn9/YqoK9FMAriAzIKaNPMds8ICNN+R//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vector Arithmetic Process\"\n        title=\"Vector Arithmetic Process\"\n        src=\"/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/828fb/vector_arithmetic_process.jpg\"\n        srcset=\"/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/ff44c/vector_arithmetic_process.jpg 158w,\n/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/a6688/vector_arithmetic_process.jpg 315w,\n/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/828fb/vector_arithmetic_process.jpg 630w,\n/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/87315/vector_arithmetic_process.jpg 771w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>For my vector arithmetic equation, I chose to use the same equation as the article.</p>\n<p><code class=\"language-text\">smiling woman - neutral woman + neutral man = smiling man</code></p>\n<h2>VAE Vector Arithmetic Results</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/1acbaa242d5054768e035633960ee508/8e1fc/vector_arithmetic_result.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.30379746835442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDAf/EABYBAQEBAAAAAAAAAAAAAAAAAAIBAP/aAAwDAQACEAMQAAABuqz2K2cI4oa5Spp//8QAHRAAAgIBBQAAAAAAAAAAAAAAAAIBAzISEyEiI//aAAgBAQABBQLkpwIhivE7C6z1N1ihpdD/xAAWEQEBAQAAAAAAAAAAAAAAAAAQARL/2gAIAQMBAT8Bpk//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwEp/8QAHhAAAAYCAwAAAAAAAAAAAAAAAAECEBExIVEiQYH/2gAIAQEABj8CRd7HdsXArFQ3oKWTkSe2/8QAHxAAAQQCAgMAAAAAAAAAAAAAAQARITEQkVFxYdHh/9oACAEBAAE/IRwB8k6xKV42M8ISJX1gTFW1KkgZi+0ZFgG7Q7w+kccgY//aAAwDAQACAAMAAAAQCM0B/8QAFxEBAQEBAAAAAAAAAAAAAAAAAREAEP/aAAgBAwEBPxBE4oLdd//EABgRAQADAQAAAAAAAAAAAAAAAAEAEBEh/9oACAECAQE/EA7QFyZP/8QAHxABAAEEAgMBAAAAAAAAAAAAAREAITFhEMFBgfCh/9oACAEBAAE/EDNWSUPhppypccueAYkJg6XL/RSUNTYMzvhe65jR1X5BGcMamkJlK1mKgbhsdNtKaSEg8HH/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vector Arithmetic Result\"\n        title=\"Vector Arithmetic Result\"\n        src=\"/vynsblog/static/1acbaa242d5054768e035633960ee508/828fb/vector_arithmetic_result.jpg\"\n        srcset=\"/vynsblog/static/1acbaa242d5054768e035633960ee508/ff44c/vector_arithmetic_result.jpg 158w,\n/vynsblog/static/1acbaa242d5054768e035633960ee508/a6688/vector_arithmetic_result.jpg 315w,\n/vynsblog/static/1acbaa242d5054768e035633960ee508/828fb/vector_arithmetic_result.jpg 630w,\n/vynsblog/static/1acbaa242d5054768e035633960ee508/8e1fc/vector_arithmetic_result.jpg 900w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Blurriness seems to get propagated, but images seem to make more sense.</li>\n<li>I think taking the average of the images is causing problems.</li>\n<li>Perhaps we need more than just 3 images to average?</li>\n<li>Perhaps a GAN would work better?</li>\n</ul>\n<h2>Latent space distributions</h2>\n<p>I wanted to get a better visualization of the latent space for each average image, so I made a histogram of each latent vector.</p>\n<p>Notice they all â€˜seemâ€™ to be a normal distribution.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/525d3/latent_dist.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.06329113924051%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACUUlEQVQoz3VTS09TURDuLyDGxOhCSHTtSjEuMO7cyEJ3btiy0/pIpGHlMzUuIBHZNHGDCzUGLQaw2AgRaQyJoDGUik1ThXpNaUF7e5/nnnP7OWcuJWw8yfTMmc58883jxlqtFrTQD6SUCAJBegjbtlGr1VCv12EYBrZqm6RHb9M02V/JgPyDKB7gO9Z+aDDXsVGu/Mbaj1/kLCGEYGkQwNpPA2bT4qBQKfwxLRTKFdiWCd8XHK9PDDvHdly+lzcaSLxcYd1iWwtvVqoYmStBUe6AEkjhYX3bQSZfZb9AKmbKgG2GjuvxvVjeQv/YJ9YbxEif5HQBF0YXWNdsVODD+Ovg0WwR48sVYrcHsF2760YML6Y+ou/x4g6gzfc9Auy+m4XlS0gK9D0XDVfg6OA0rj7/wj5C7GGoJRA+XCHROTCJ/icRQ9fzuIdnh+dx6Ppr5A09DAWPkjsE3jUwhfiz/wAKn4IDhWM3Z9D78AN8XQbZjG0Lp5LvcODaBLKrumcKipKXNi22Jca/Rq2gxLslq1CvjUSuWEPnjUkupVht8kDSS+s4TDbNsHdkgVj7PJT408/ouPQK50dzaFL5eitabYYMCInU+xI6LqdZhrLfOeNYroT9VyZwkACPUKJaw4Fp2Tj9YA774ml0JaYoObUCITRMLAyjKa9u1HFueBY9ySy6b2fQl8pxGwZfLOH4rQzO3M/i5J0ZzH8zUCBf/e5JvsUJ8h3K5BlQL8zu2uhdcmglAv21kHg0IKVC6k1AvZUsvpDcZ0l2zw+i/8jX9sTu1/IPev8OzFzIMY0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Latent space distributions\"\n        title=\"Latent space distributions\"\n        src=\"/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/f058b/latent_dist.png\"\n        srcset=\"/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/c26ae/latent_dist.png 158w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/6bdcf/latent_dist.png 315w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/f058b/latent_dist.png 630w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/40601/latent_dist.png 945w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/525d3/latent_dist.png 1090w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>I also noticed the distribution of the first few values of the latent vector and\npossibly all the values of the latent vector to follow a normal-ish distribution\nwhen comparing each corresponding value in 90 different predictions.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f583f9c84248a360895752699ebf069d/024d6/3_value_dist.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.43037974683544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACWUlEQVQoz11STWsTURTNwo24UUSta3+CG/UPuHChoN2K0IWgYEld6cKNVAUXxX5AKVoo4qKtJQ3FqjXGxEqC1mBKbG0am4+2SdqGySTzmfl4c3zvTlJLLwwM95133jn33IDneRDFGIOqqqiWt1HI5yFJEhRFQW1vz+8Vi6hUKmg0GpBlGcVSCbXdHcJYlkUcgivQ+TFME4am4k+pivKeBMe2YLVaaKgG0hsVKM0GdF2H4ziwbJv/a0itb0GqyzAMA67rEikRCpCiatSYW64imq0JzdCbMpIbNfRMpNApwzBJlaiJZAmCxuPubM6xT0h2NZ0aU0ubeDT7W8AAS8Oz+RVcevoZLseIanHVmu5jXycLMG0XzHVI1H+FXK7VMqG1HFweiOP5xzUidE0Vg5Esjt8LIb0p+wr5aMi6y/BqMU891zlESHKZjVSpjqN33mIomiPLjBOOfsnh2N0ZLBUkuqBxy8xuoSwbpDy7oxBWzPUAIZ+Ea5OKk70hvIis06FI89rwIk4Hw/jFHxNliqAUFe8zFZy9H0b/u1V/FNZhQv5KblfFmb4wukcTZKMuN3Ch/xO6+MUPmSra/pDIVnDxSQRdHNs3laa23VHo76GHal3laf7klmdw7uE8MlsSNFXB+ccLCPRMIjiZbufMMB7P4sjtaZziyk/0zmIsliMOxqkCrL3Yoe9/cWUgiptj33B9OI7x2Bp0TUHwzQ9cHYxhaGEFy8UaqlIT8dVtdI/EcetlAjdGvuLBdIrvrX1wbTyKXrze+TyevL+snt9jLg2eAvQ6OG//nLXX6h+zWRbG6N29QgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3 Value dist\"\n        title=\"3 Value dist\"\n        src=\"/vynsblog/static/f583f9c84248a360895752699ebf069d/f058b/3_value_dist.png\"\n        srcset=\"/vynsblog/static/f583f9c84248a360895752699ebf069d/c26ae/3_value_dist.png 158w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/6bdcf/3_value_dist.png 315w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/f058b/3_value_dist.png 630w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/40601/3_value_dist.png 945w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/024d6/3_value_dist.png 961w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Note the distributions are â€˜normal-ishâ€™ but donâ€™t always have a mean of 0.</li>\n</ul>\n<h2>Conclusion</h2>\n<ul>\n<li>Iâ€™d like to retry this experiment with a GAN to see if performance is better.</li>\n</ul>\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/\">https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/</a></li>\n</ul>","frontmatter":{"title":"Vector Arithmetic with VAE","date":"February 19, 2022","description":null}},"previous":{"fields":{"slug":"/wk-7-reduce-blury-vae/"},"frontmatter":{"title":"VAE Experiments for Reducing Blury Decoder Output"}},"next":{"fields":{"slug":"/wk-10-gan-vector-arithmetic/"},"frontmatter":{"title":"Vector Arithmetic with GAN"}}},"pageContext":{"id":"18f1d2b0-e9ff-5e51-8bff-032bf898468c","previousPostId":"0fd37f52-a717-515f-9bfd-187a39a0e0ca","nextPostId":"55b68a22-b6f8-5fd8-9847-32268eea52f5"}},
    "staticQueryHashes": ["2841359383"]}