{"componentChunkName":"component---src-templates-blog-post-js","path":"/wk-8-vector-arithmetic/","result":{"data":{"site":{"siteMetadata":{"title":"Vyn's Blog"}},"markdownRemark":{"id":"c6a8c8e1-0f57-50ad-898c-57f72b7e7702","excerpt":"Building an accordion AE to retry experiment from last week Accordion V1  Blocking effect seems to be happening. After testing new architecture, it does notâ€¦","html":"<h2>Building an accordion AE to retry experiment from last week</h2>\n<h3>Accordion V1</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_1 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>     <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>              <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">3584</span>\n_________________________________________________________________\nconv2d_1 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">147584</span>\n_________________________________________________________________\nconv2d_2 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295168</span>\n_________________________________________________________________\nbatch_normalization <span class=\"token punctuation\">(</span>BatchNo <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1024</span>\n_________________________________________________________________\nconv2d_transpose <span class=\"token punctuation\">(</span>Conv2DTran <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295040</span>\n_________________________________________________________________\nconv2d_transpose_1 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">73792</span>\n_________________________________________________________________\nconv2d_transpose_2 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1731</span>\n_________________________________________________________________\nconv2d_3 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">3584</span>\n_________________________________________________________________\nconv2d_4 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">147584</span>\n_________________________________________________________________\nconv2d_5 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295168</span>\n_________________________________________________________________\nbatch_normalization_1 <span class=\"token punctuation\">(</span>Batch <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1024</span>\n_________________________________________________________________\nconv2d_transpose_3 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">295040</span>\n_________________________________________________________________\nconv2d_transpose_4 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">73792</span>\n_________________________________________________________________\nconv2d_transpose_5 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">1731</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">635</span><span class=\"token punctuation\">,</span><span class=\"token number\">846</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">634</span><span class=\"token punctuation\">,</span><span class=\"token number\">822</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">024</span>\n_________________________________________________________________</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/f569a/convAE_accordion_v1_inout.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 248.1012658227848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAyABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIEAwH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAdLfJYWw3WJgejwnLzRJSo0SZeo0f//EAB8QAAMAAgAHAAAAAAAAAAAAAAECAwARBBITIjEzNP/aAAgBAQABBQKkoBnjEL0YsGmpJQNhAXGZVYlVViDhQm1VJwjWcl0pRKFu7KHTudIdkU+niPSfH//EABYRAAMAAAAAAAAAAAAAAAAAABARIP/aAAgBAwEBPwEKv//EABYRAAMAAAAAAAAAAAAAAAAAABARIP/aAAgBAgEBPwEOv//EACIQAQABAwMEAwAAAAAAAAAAAAEAAhExAxJRISJBcSMyYf/aAAgBAQAGPwI+MsZibDME0yXY35gEByypq5gmLTqXJ05gHEaqXcPh8Tdp1YfrO8B/JTbMq9wvm005V7lPqf/EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExQRBRYaGx/9oACAEBAAE/IRbwLmGS5VPaBobJaxmREpQTQCbbWiawhSwNqxLjpWB2bpwySg0Ig3z2B1RyWwy2EiUabNVxNzTLJEjsyn29H9TP/9oADAMBAAIAAwAAABDjDEzvD7z/xAAYEQADAQEAAAAAAAAAAAAAAAABEBEhMf/aAAgBAwEBPxDVFAUQ6F//xAAZEQACAwEAAAAAAAAAAAAAAAABEAAhMRH/2gAIAQIBAT8QuCGhXdRwr//EACEQAQEAAgIBBAMAAAAAAAAAAAERACExQWEQUaHBcZGx/9oACAEBAAE/ENyM0HY+rhLZBGwTBHmwR5FH+ZIMrZSOBMjaGe2MPdVvlx8AoJ31f1mxNzRXrjJMBIcI3Ddi0eBDXzlO92HkMJKUHAc5Z2rQCvR+NYlVoSNotcW8A0VJWZ2mhdhN0w3O6ViSd4Y4BQcXefF+3q4P/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Accordion AE input/output\"\n        title=\"Accordion AE input/output\"\n        src=\"/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/f569a/convAE_accordion_v1_inout.jpg\"\n        srcset=\"/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/ff44c/convAE_accordion_v1_inout.jpg 158w,\n/vynsblog/static/23333ebea102a2c728d1e1d95a530ee4/f569a/convAE_accordion_v1_inout.jpg 266w\"\n        sizes=\"(max-width: 266px) 100vw, 266px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Blocking effect seems to be happening.</li>\n<li>After testing new architecture, it does not seem to help much with reducing blury output.</li>\n</ul>\n<h2>Using CelebA dataset for vector arithmetic</h2>\n<h3>Dataset sample</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/71ee9/celeb_dataset.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.92405063291139%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACYUlEQVQ4y32T309SYRjH+be69qbWTbelbd2Yqzk3t5qVJoppIphJCrj0CP4gKGSgoibiouGPBDTQ1BUDi5QJcVL5zTnwbT7HX6DrXH2efd/3s/d5z/uIAKBQKOD0u8jART7O8mecz+eL9pzuE51C/PAvdkM7xHtsGnbvLjIcwHM5uBbmwUbDlM3NzWJlZZmY/RNG+PePIrEoz/NU2Ex6iB9WEk8v+VFV0w42A6QOo2itvIllh42yp/fLIXv+mNj7+QNsmvoS4cnRXYsOaJVdxJtb21B0SnGUSCKezmFqtA+7G0uUWbVv8NE0QhwO+RHY9hS1fSYcG+jGkOwZ8fb6AiTV18HGIuCyKbg6byPum8FxL/1PKqBurKZ1X1eWYH2nPbvvIuGEyQjjiBB+W19FbfU9sCwLgIffPYPYfoiyjrZm9PR0E3ucDpgHmdKWhTvUq6RoeHCHeNxiRsWNMkQjEaSzHF7Xv4Tb5aOsXSpG/1sFsdu+AOaFGvkrT2jQoKejkXjDuwqmS4pkKo1UIgmmtQ2+Ly7KjBo15i3vBeHiGrpeMeCvEjLKJtQ+KicOhcKQ1NzFQXQPB0dxaDrrEPzuFYQNdbB0tBCvOuwYFleB5/jzlgsnwjWnBQadivjnThDTOiX4TALxZAJjvU3weYS3NzbYh0njkPBT7NOY7G1BLpu7LPS6PXBOmogD6x74bGZiLpuBXiXHxuYW1UOGYcjlzcQKWStulV1DJsddFk5YxjGgEN5hLBRA8JP1eAWy2QxmR9UI/xKmSNengnNminjeagYjk5QIBbpyli/O7v9n/rz+B/sznWZa2V2VAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CelebA dataset sample\"\n        title=\"CelebA dataset sample\"\n        src=\"/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/f058b/celeb_dataset.png\"\n        srcset=\"/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/c26ae/celeb_dataset.png 158w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/6bdcf/celeb_dataset.png 315w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/f058b/celeb_dataset.png 630w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/40601/celeb_dataset.png 945w,\n/vynsblog/static/eb479a9580fd56f7ac0756d62ee878e6/71ee9/celeb_dataset.png 1081w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Preprocessing</h3>\n<p>To increase model performance, only the faces in each image were extracted using a pre-trained Multi-Task Cascaded Convolutional Neural Network (MTCNN).\nBelow are the same faces as above, but only the face extracted.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/6af66/celeba_extracted.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAADKElEQVQ4y62U20+bZRzH+ZdMpskuvNM/QBPNjDdEI8mcCoomTM3MwtxwHIKDQTZYRzkIpIO62rCOKaWsrUApLS2l9EBfenjfHig98K5vadf2Yxh0NeFSn6vnufnk+83n93uaAGq1Gv/11BlN9UuxWCQhBBACfkrlMkeJCMWDKKXSMfmUSCG5z8tSEVGMEfI4OMoeUjpWSEV85A+Tr6FN1Wr11SMc9DP5TTPdX3xK6iDNbPvH+O51UDjK4nt8F8vtzxAFH65lA8vdHeytmoj5NnnS28K6buQMWG0ABUFAc+tH5gd7OMzLjF//ns3xO8jKMUHTHCujP5NMxtm3W3BODrNtWyWbEFib6SFoMzQS1s6AUjiEvvsHNubHKRYL7JhmePbgGtnDFJ4/VPi0v5JPJ8h7TQgTXyM5jCRFEbvmIUHb8/OVoyE/062fYB8bolop8XjwO9reu0Auk8I33UNU10utJBN/rsHcdhHr71OI+yEW+27gfKqndko8kXIKTMVj/DXWyzONmvyLAv5VAwtjg6QzWfJuCzH9BLlEAmlvB8/iI/zebTLxCFtzakI28/mEwW0nmssXmOz4gJysYL7fydKNNnK5HLsP+7n3zkV2bQ72PRbME7cIe23EvS4Wv7qESzN2Xko4HEbbdxXj1BBKqYxVN4PpNxWyXCC4ZMA40I0UiRFw29iYGyYW9HAgRnHOjuBfNVOtV64DpWiAq81vMnKzhfLLCo+GOxnteJ9s5gC3bhTrQCv5jMTeylNsXVeI200kAi5Sy3fIOPWcjvO/LKclP4NX3mC6/zLH5TKqzi+Z+ukj5Fwax+xdVm+2kIkLrC1omW/7EGHNiORzIulvk1rXUXkNPNuUTFLCoVfjXtKiKAp/a9X4TAbK5TJek44tzRByOo5l2UhXext22ybR4C5mdR+u5YWG5XrlmBBg7trnPBm4TlEp4FR1YfzlW5TCC9YnetC1XyIZ3kMzMkzr22+xbbWys2HhQfO7GFX9DSn1hCc2PdYVQq5NKpUKciyEHPa/GoVsxE90a42CUiQS8CNtrVNVZERRxGv5k5DX3Uj4f/02J7ATyj+bCBjcmL+PNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CelebA extracted faces\"\n        title=\"CelebA extracted faces\"\n        src=\"/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/f058b/celeba_extracted.png\"\n        srcset=\"/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/c26ae/celeba_extracted.png 158w,\n/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/6bdcf/celeba_extracted.png 315w,\n/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/f058b/celeba_extracted.png 630w,\n/vynsblog/static/38ea1ef03c6766168a12f490c2b51a2c/6af66/celeba_extracted.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>VAE Model for vector arithmetic</h2>\n<p>Note: The model from the article is a GAN, I chose to use a VAE to keep our experiments more consistent with the â€˜autoencoderâ€™ structure.</p>\n<h3>VAE Version 1</h3>\n<h4>Encoder</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model\"</span>\n__________________________________________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                    Output Shape         Param <span class=\"token comment\">#     Connected to</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\ninput_1 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token number\">0</span>\n__________________________________________________________________________________________________\nconv2d <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>                 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>  <span class=\"token number\">3584</span>        input_1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nconv2d_1 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>   <span class=\"token number\">73792</span>       conv2d<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nconv2d_2 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>   <span class=\"token number\">18464</span>       conv2d_1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nconv2d_3 <span class=\"token punctuation\">(</span>Conv2D<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>     <span class=\"token number\">4624</span>        conv2d_2<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nbatch_normalization <span class=\"token punctuation\">(</span>BatchNorma <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>     <span class=\"token number\">64</span>          conv2d_3<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\nflatten <span class=\"token punctuation\">(</span>Flatten<span class=\"token punctuation\">)</span>               <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>           batch_normalization<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\ndense <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>                   <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">102656</span>      flatten<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\ndense_1 <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span>                 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">102656</span>      flatten<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n__________________________________________________________________________________________________\n<span class=\"token keyword\">lambda</span> <span class=\"token punctuation\">(</span>Lambda<span class=\"token punctuation\">)</span>                 <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>           dense<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n                                                                 dense_1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">305</span><span class=\"token punctuation\">,</span><span class=\"token number\">840</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">305</span><span class=\"token punctuation\">,</span><span class=\"token number\">808</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">32</span></code></pre></div>\n<h4>Decoder</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Model<span class=\"token punctuation\">:</span> <span class=\"token string\">\"model_1\"</span>\n_________________________________________________________________\nLayer <span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">)</span>                 Output Shape              Param <span class=\"token comment\">#</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\ninput_2 <span class=\"token punctuation\">(</span>InputLayer<span class=\"token punctuation\">)</span>         <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>             <span class=\"token number\">0</span>\n_________________________________________________________________\nintermediate_decoder <span class=\"token punctuation\">(</span>Dense<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>               <span class=\"token number\">102800</span>\n_________________________________________________________________\nreshape <span class=\"token punctuation\">(</span>Reshape<span class=\"token punctuation\">)</span>            <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>          <span class=\"token number\">0</span>\n_________________________________________________________________\nconv2d_transpose <span class=\"token punctuation\">(</span>Conv2DTran <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">4640</span>\n_________________________________________________________________\nconv2d_transpose_1 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>        <span class=\"token number\">18496</span>\n_________________________________________________________________\nconv2d_transpose_2 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>       <span class=\"token number\">73856</span>\n_________________________________________________________________\nconv2d_transpose_3 <span class=\"token punctuation\">(</span>Conv2DTr <span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>         <span class=\"token number\">3459</span>\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nTotal params<span class=\"token punctuation\">:</span> <span class=\"token number\">203</span><span class=\"token punctuation\">,</span><span class=\"token number\">251</span>\nTrainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">203</span><span class=\"token punctuation\">,</span><span class=\"token number\">251</span>\nNon<span class=\"token operator\">-</span>trainable params<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></code></pre></div>\n<h2>VAE Reconstruction results</h2>\n<p>The result here is better than I expected for a VAE of this size, output was expected to be blurry, but one can make out who the face is. It might be worth using a GAN for future experiments as thatâ€™s what was used in the article.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f00413ed41a35814e7263688d80f8217/6af66/conv_vae_v1_results.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAADJElEQVQ4y62U20/aZxyH/XuWmSy72eWS3TZZmvVqS9t0W9bMxtYak61ZtriDB1zaTZZU3TxgrC3iYWir00jFAyCiYhEFOSP4+wGCHIUfhQLPMitjibvb3qv3vXny+eT5ft86gEqlwn89VUZd9ZKXJEI+Jz6Xg0KxSDocIBcNUii8JB0VyEb8FAt5REHAs7dDJhGnkJc4DjhInUT+htaVy+WzR8DtZLjpIzo+v0o0FuNx8xX2HjaRSyew/S5H23EdwXuARfsHC513cRm1HDl3mO68jkHdcw4s14B+nxdl2xdMyDuJp09RfNeCcfg+p5KEQ6vieW8rkYiIb1uHaUSO1bROIuxHN9KJc32ulrByDgwFfEzLvsQ0MUQ+L2FdGmW29x7JeJTdmX6sE/dJnYRJ2VZwDtxGMC8REQU2VP04TSsXKwteJ6O3r2JSyCmVCkzKm2m89CapRBT7ExmecRmv8mnEtXGWb72NTv0Iwe9l9kEr5oWZqpm/pLwGHocEFgdkLCgHSZ/mODDMMzPYzUkiSdKqw/d0iEQkhOi1sbOoxHGwRzwUxDw5iNu0ejGhZ38H5cf1KO6+T/I0x0pPK/Pf3yKVSmEfesAv772FfXMb/74BjeJbvPsbhOxW5ho/4IVq4KKUQOAQVVcLmhE5UqGIXj3K0mgfmWwWl3YOTXcHYiCIy2rCOCYn6LISFYJsPe7DYVylUq1cBYoBFy0f1tP7ww0Kr0qM9XxNX/MlkvEYluk+VrsbSMVEPGvzGNpvIm4uEfbsEtT8zLFZTfk1sWY5duRG/skbPOr6lJfFIr+13mT43hUyyRjbSjlrbTeIi16Ms1OoGi/jNT5HdFnwqdsRNqb+ATzflMRxiK3pISyLU0hSDv3kMLblZxSLBWxaNeYxOZlYCL1WS9udBrY3twi67awMdbGrffovlX0uxr76jGc/fUNeyrLZ38ZC+x2kXBajQsZE02XCh27Gf31Iwzv17OpXsW3p6bv2LpqBH2tSqglTySRWwzIeq5lSqUT6yEPq0HE2ComAk8MX62Ql6WxFRcsGpVwGURSx6Rbx2q21sfm/f5s/AZnuEn4/kLeDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Convolutional VAE V1 Reconstruction Results\"\n        title=\"Convolutional VAE V1 Reconstruction Results\"\n        src=\"/vynsblog/static/f00413ed41a35814e7263688d80f8217/f058b/conv_vae_v1_results.png\"\n        srcset=\"/vynsblog/static/f00413ed41a35814e7263688d80f8217/c26ae/conv_vae_v1_results.png 158w,\n/vynsblog/static/f00413ed41a35814e7263688d80f8217/6bdcf/conv_vae_v1_results.png 315w,\n/vynsblog/static/f00413ed41a35814e7263688d80f8217/f058b/conv_vae_v1_results.png 630w,\n/vynsblog/static/f00413ed41a35814e7263688d80f8217/6af66/conv_vae_v1_results.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Vector Arithmetic process</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/87315/vector_arithmetic_process.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 139.24050632911394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAcABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAe6uhEcWguRUUZ//xAAcEAABBAMBAAAAAAAAAAAAAAAAAQIQEQMiMUH/2gAIAQEAAQUCjePVZZwXhkS2tKP/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAVEAEBAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwI1/wD/xAAdEAEAAgIDAQEAAAAAAAAAAAABABEhMUFRcRCR/9oACAEBAAE/Ibcxuit+S7vXEMr7EOxRAplqBktRlufmBZvG7t/Z/9oADAMBAAIAAwAAABCnyb//xAAYEQADAQEAAAAAAAAAAAAAAAAAAREQMf/aAAgBAwEBPxDjKSq5/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEREDH/2gAIAQIBAT8QXCIuf//EAB0QAQADAAMBAQEAAAAAAAAAAAEAESExQVFhgeH/2gAIAQEAAT8QKNuPkAYPLwyjc136/Zk39UxQGhC7zY8kaBj5LjaLZ/fsVUFesYBXEBmQU0aeY7Z4QEab8j//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vector Arithmetic Process\"\n        title=\"Vector Arithmetic Process\"\n        src=\"/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/828fb/vector_arithmetic_process.jpg\"\n        srcset=\"/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/ff44c/vector_arithmetic_process.jpg 158w,\n/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/a6688/vector_arithmetic_process.jpg 315w,\n/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/828fb/vector_arithmetic_process.jpg 630w,\n/vynsblog/static/1debef3d2664beb28e2d6d6a67c21bd6/87315/vector_arithmetic_process.jpg 771w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>For my vector arithmetic equation, I chose to use the same equation as the article.</p>\n<p><code class=\"language-text\">smiling woman - neutral woman + neutral man = smiling man</code></p>\n<h2>VAE Vector Arithmetic Results</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/1acbaa242d5054768e035633960ee508/8e1fc/vector_arithmetic_result.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.30379746835442%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAQD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgEA/9oADAMBAAIQAxAAAAG6rPYrYI4Ia5Spp//EAB0QAAICAQUAAAAAAAAAAAAAAAACAQMyEhMhIiP/2gAIAQEAAQUC5KcCIYrxOwus9TdYoaXQ/8QAFhEBAQEAAAAAAAAAAAAAAAAAEAES/9oACAEDAQE/AaZP/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEQ/9oACAECAQE/AcqP/8QAHRAAAQQCAwAAAAAAAAAAAAAAMQABEBECUSJBgf/aAAgBAQAGPwLAna7MNwYoVHqa4xVvuP/EAB8QAAEEAgIDAAAAAAAAAAAAAAEAESExEFFhkXHR4f/aAAgBAQABPyEaA+SfYlK8djOEJEr6wK1bqVJAzF+0ZFgG8res+kcbAx//2gAMAwEAAgADAAAAEAgNAf/EABcRAQEBAQAAAAAAAAAAAAAAAAERABD/2gAIAQMBAT8QROKC3Xf/xAAXEQEBAQEAAAAAAAAAAAAAAAABEBEh/9oACAECAQE/EA7ALkf/xAAfEAEAAQQCAwEAAAAAAAAAAAABEQAhMWEQwUFx8IH/2gAIAQEAAT8QnVZJQ+GknKlxy54BiQrHS5f6KShqbBmd8Kfu5TR1U34EZwxqaZmUrWUQbxsdNtQmyEg8Ecf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Vector Arithmetic Result\"\n        title=\"Vector Arithmetic Result\"\n        src=\"/vynsblog/static/1acbaa242d5054768e035633960ee508/828fb/vector_arithmetic_result.jpg\"\n        srcset=\"/vynsblog/static/1acbaa242d5054768e035633960ee508/ff44c/vector_arithmetic_result.jpg 158w,\n/vynsblog/static/1acbaa242d5054768e035633960ee508/a6688/vector_arithmetic_result.jpg 315w,\n/vynsblog/static/1acbaa242d5054768e035633960ee508/828fb/vector_arithmetic_result.jpg 630w,\n/vynsblog/static/1acbaa242d5054768e035633960ee508/8e1fc/vector_arithmetic_result.jpg 900w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Blurriness seems to get propagated, but images seem to make more sense.</li>\n<li>I think taking the average of the images is causing problems.</li>\n<li>Perhaps we need more than just 3 images to average?</li>\n<li>Perhaps a GAN would work better?</li>\n</ul>\n<h2>Latent space distributions</h2>\n<p>I wanted to get a better visualization of the latent space for each average image, so I made a histogram of each latent vector.</p>\n<p>Notice they all â€˜seemâ€™ to be a normal distribution.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/525d3/latent_dist.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.06329113924051%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACUUlEQVQoz3VTv08UURC+v4AYE6OFkGhtpRgLjJ2NFNrZ0NLpqSRAqBQ1ZywgEWlIbLBQY0AgcB5ehIhcDImgMRwnXi6ngGuOW9Db292379fuZ94shzS+ZDIzb2e+/ebHS0RRBCOIIiilIKUAohCe56FarcK2bViWhZ3qNmw79h3HoXitJKSUcT5AOtFwDBjzPZS3fmH9+09opSCEIKk5DtZ/WHDqLiWFWuO346JQ3oLnOuBcUL45Cewdz2ekVzZr6B1fJduluwivVysYmi9BR4AUAkoE2Nj1kclXKE4qTUwJsMHQZwHppfIOOkc/kl2ru6RT6QKuDC+SbdhoyWH98fF4roixlS2og4CN2hmLGV4d+YCOJ0t7gB7p++kCWu9l4XIFJSV4wFBjAif70rj54jPFCHGAoREpOJhQaO6ZRufTmCELAurhxcEFHOuaQt4yw9AIGIPPFVp6ZpB8/h9AwQMIqXHq9izaH70HN2XwANaui3OptzhyaxLZNdMzDS04Stsu3fWOfYlbIcS/knVo1kYhV6yiuXuaSilW6jSQieUNHO+eJobtQ4tgAaehJJ99QtO1V7g8nEOdCdqKqMGQAKEw8q6EpusTJAPZb/TH0VwJh29M4mjXFE70pVGt+XBcD+cfzuNQcgItvTMoVhwAIQxMIgzjKa9t2rg0OIe2VBat/Rl0jOSoDX0vl3H6TgYXHmRx9u4sFr5aKGza5Lel3uBMfwYDmTwBmoXZXxuzSz4XkOa1KIVAKGgdggsJIRUJF4r6rHSIgMv4m1LwArH/Wv4Cev8OzOPCrEEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Latent space distributions\"\n        title=\"Latent space distributions\"\n        src=\"/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/f058b/latent_dist.png\"\n        srcset=\"/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/c26ae/latent_dist.png 158w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/6bdcf/latent_dist.png 315w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/f058b/latent_dist.png 630w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/40601/latent_dist.png 945w,\n/vynsblog/static/819ab0e4bf512a10d12f9b59abb67809/525d3/latent_dist.png 1090w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>I also noticed the distribution of the first few values of the latent vector and\npossibly all the values of the latent vector to follow a normal-ish distribution\nwhen comparing each corresponding value in 90 different predictions.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f583f9c84248a360895752699ebf069d/024d6/3_value_dist.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.43037974683544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACVElEQVQoz12SzUtUYRTGZ9FG2hRR2bo/oU31D7RoUVBuI3ARGCSjq1q0CStoIfkBIiVItFATHSIrM3MylLKhEdMcJ3XGjxl1mLnj/f567y/uOzMpHrhwec5zn/uc85xIEASEJYRA0zTy21usr61RLBZRVZXC3l4Fy2TI5XKUy2UURSGTzVLY3ZEcx3GkRqgVqb2YloWpa/zJ5tneK+K5Do5tU9ZMkqs51P0yhmHgeR6O62IYOomVTYolBdM08X1fikrBkKRqugTezueZTBVCzxj7CrOrBRr7E9TKNC3pKqz+2SyhTCAErucdCMpxdUMCg3MbPBz9HdLA0Xk6tsjlJ5/xhZB927bRjQr31ew6lusjfE+aOnDo+zi2hW57XGmP8+zjshT0LY2OiRQn7o2Q3FAqDi2rMroveDm9JjHfOyIo7QqXRLZEXdMbOifTcmRhafR8SXP87jBz60X5gW5aCNdmWzGl89SOKrnhXg8J+uC70sWp5hGeT6zIZpjm9a5pzkRj/MqWJGaFQaka7xdynGuN0fZuqbIK56gggvSuxtmWGA09M3KMklLmYtsn6ltjfFjIU52PmVSOS48nqG+J0TKYlLBbc1i5w4B8SaOx/yd1TcOcfzDGwmYRXVO58GicSOMA0YFkNWdBXzzFsTtDnI7GONk8Su9UWmqIACKietgj3/9ytX2SW73fuNEVp29qGUNXib7+wbWOKTrHF5nPFMgX94kvbdHQHef2ixludn/l/lAC7/AOhQhk9OHfa0/g+9VjDSqY8OXiZYBBjRf874vqWf0Ds1kWxhzdB54AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3 Value dist\"\n        title=\"3 Value dist\"\n        src=\"/vynsblog/static/f583f9c84248a360895752699ebf069d/f058b/3_value_dist.png\"\n        srcset=\"/vynsblog/static/f583f9c84248a360895752699ebf069d/c26ae/3_value_dist.png 158w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/6bdcf/3_value_dist.png 315w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/f058b/3_value_dist.png 630w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/40601/3_value_dist.png 945w,\n/vynsblog/static/f583f9c84248a360895752699ebf069d/024d6/3_value_dist.png 961w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Note the distributions are â€˜normal-ishâ€™ but donâ€™t always have a mean of 0.</li>\n</ul>\n<h2>Conclusion</h2>\n<ul>\n<li>Iâ€™d like to retry this experiment with a GAN to see if performance is better.</li>\n</ul>\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/\">https://machinelearningmastery.com/how-to-interpolate-and-perform-vector-arithmetic-with-faces-using-a-generative-adversarial-network/</a></li>\n</ul>","frontmatter":{"title":"Vector Arithmetic with VAE","date":"February 19, 2022","description":null}},"previous":{"fields":{"slug":"/wk-7-reduce-blury-vae/"},"frontmatter":{"title":"VAE Experiments for Reducing Blury Decoder Output"}},"next":{"fields":{"slug":"/wk-10-gan-vector-arithmetic/"},"frontmatter":{"title":"Vector Arithmetic with GAN"}}},"pageContext":{"id":"c6a8c8e1-0f57-50ad-898c-57f72b7e7702","previousPostId":"9d326f16-f062-52bc-b02c-cf8aa784595b","nextPostId":"45262ec5-2062-5cdb-a93e-2836910fd016"}},"staticQueryHashes":["2841359383"]}