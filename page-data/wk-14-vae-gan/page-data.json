{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/wk-14-vae-gan/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Vyn's Blog"}},"markdownRemark":{"id":"b9f0418c-09e6-5ea8-8069-05aa6f0bbe66","excerpt":"Overriding the training function in Sequential model Problem: Need to access output of generator during the GAN training process. Typically, only have access toâ€¦","html":"<h3>Overriding the training function in Sequential model</h3>\n<p><strong>Problem</strong>:</p>\n<ul>\n<li>Need to access output of generator during the GAN training process. Typically, only have access to the output of the discriminator.</li>\n<li>Need access to the input data <code class=\"language-text\">x</code> during training to measure the reconstruction loss.</li>\n</ul>\n<p><strong>Solution</strong>:</p>\n<ul>\n<li>Wrap loss function in function that takes the generator, as well as alpha and beta as parameters.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">loss_wapper</span><span class=\"token punctuation\">(</span>g_model<span class=\"token punctuation\">,</span> alpha<span class=\"token punctuation\">,</span> beta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mse <span class=\"token operator\">=</span> MeanSquaredError<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    bce <span class=\"token operator\">=</span> BinaryCrossentropy<span class=\"token punctuation\">(</span>from_logits<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">loss</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        y <span class=\"token operator\">=</span> g_model<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        ae_loss <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span>scalar_mul<span class=\"token punctuation\">(</span>alpha<span class=\"token punctuation\">,</span> mse<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        gan_loss <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>math<span class=\"token punctuation\">.</span>scalar_mul<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">,</span> bce<span class=\"token punctuation\">(</span>y_true<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># Here is where I plotted the ae_loss and gan_loss values in order to tune alpha and beta</span>\n        <span class=\"token keyword\">return</span> ae_loss <span class=\"token operator\">+</span> gan_loss\n\n    <span class=\"token keyword\">return</span> loss</code></pre></div>\n<ul>\n<li>Override train_step function in Sequential model to call loss function with the input data <code class=\"language-text\">x</code>.</li>\n</ul>\n<p><em>Note</em>: <code class=\"language-text\">my_loss</code> gets set to the loss function above.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">VAEGAN</span><span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">compile</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> optimizer<span class=\"token punctuation\">,</span> my_loss<span class=\"token punctuation\">,</span> run_eagerly<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token punctuation\">,</span> run_eagerly<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>my_loss <span class=\"token operator\">=</span> my_loss\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">train_step</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> sample_weight <span class=\"token operator\">=</span> data_adapter<span class=\"token punctuation\">.</span>unpack_x_y_sample_weight<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">with</span> tf<span class=\"token punctuation\">.</span>GradientTape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> tape<span class=\"token punctuation\">:</span>\n            y_pred <span class=\"token operator\">=</span> self<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> training<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n            loss_value <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>my_loss<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span>\n\n        grads <span class=\"token operator\">=</span> tape<span class=\"token punctuation\">.</span>gradient<span class=\"token punctuation\">(</span>loss_value<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>trainable_variables<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>optimizer<span class=\"token punctuation\">.</span>apply_gradients<span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>grads<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>trainable_variables<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"loss\"</span><span class=\"token punctuation\">:</span> loss_value<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>Note</em>: eager execution allows access to the tensors (for debugging) inside the loss function. So I was able to print out and display values and stuff like that.</p>\n<h2>Note on learning rate</h2>\n<ul>\n<li>If loss is unstable (going up and down violently).</li>\n<li>Need to reduce learning rate.</li>\n<li>Gradient descent is taking too large of steps, and jumping out of the minima.</li>\n</ul>\n<h2>Verification of loss function</h2>\n<h3>Verification test 1</h3>\n<ul>\n<li>If alpha = 1 and beta = 0, should get same result as training a typical autoencoder. This is because the loss will be only the reconstruction loss, and only depend on X and output of the generator (AE) y.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/331f6e9a8f8f55639019d8b4cdea2473/b3430/loss_verify_1_output.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.810126582278485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdSYNgT/xAAWEAEBAQAAAAAAAAAAAAAAAAABAAL/2gAIAQEAAQUCTVsWxf/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAABAjFx/9oACAEBAAY/ApWIen//xAAbEAACAgMBAAAAAAAAAAAAAAABEQAxIUFRcf/aAAgBAQABPyFwh1vyYg6NGMA0f//aAAwDAQACAAMAAAAQ8A//xAAXEQADAQAAAAAAAAAAAAAAAAAAATER/9oACAEDAQE/ENg6f//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPxDEf//EABoQAAMBAQEBAAAAAAAAAAAAAAERIQBBMYH/2gAIAQEAAT8Qan0rmhFceH4giu3AJc0ryb//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"loss verify 1 output\"\n        title=\"loss verify 1 output\"\n        src=\"/vynsblog/static/331f6e9a8f8f55639019d8b4cdea2473/828fb/loss_verify_1_output.jpg\"\n        srcset=\"/vynsblog/static/331f6e9a8f8f55639019d8b4cdea2473/ff44c/loss_verify_1_output.jpg 158w,\n/vynsblog/static/331f6e9a8f8f55639019d8b4cdea2473/a6688/loss_verify_1_output.jpg 315w,\n/vynsblog/static/331f6e9a8f8f55639019d8b4cdea2473/828fb/loss_verify_1_output.jpg 630w,\n/vynsblog/static/331f6e9a8f8f55639019d8b4cdea2473/0ede0/loss_verify_1_output.jpg 945w,\n/vynsblog/static/331f6e9a8f8f55639019d8b4cdea2473/b3430/loss_verify_1_output.jpg 1122w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<em>Note</em>: this output is the model trained at 23 epochs.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/c9d77/ae_loss_1_unscaled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.0253164556962%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAB7CAAAewgFu0HU+AAACCElEQVQoz3WTu2sVQRSH89/YK2gtiIWdlaWgWOg/YWFjIRbBNIoIgiA+UAsLH0FBQYQIFgpiEoRVCTfezb4fsztzPs/M7t6bgA6c3ZnZM9/+zmNWRAQ/nHP0fa9msbbHGEOWZQesLEvyPKduGvVx4Yy1Ntg0ViagBxjT0psmQCdgmqYLK4p8AJY5ma6jKGI2m5EkCV3XDUD/8NCqrhFVhin577Dt8O5rrKmpqnqh0As4APRhuBEo497CbIf0Binnw7qKFa4A1y3S1S2BQ8i1KnT61wmIT0UwB9nvYFLMFK4Hf31CugYxlapVIX2H2R9yp8WoND9SJ+rQDkDXL0Odb8L2W4g+wo/38OSiHqqQJlP4Bm7nC8YFFQPQ06si01D2wmHZfAVpBN+ew/cX8PAc3DkFd0/DjaPD/PEF5MFZWD2M+3yfELBYBY6h+aK4r8/g0Xnk5nHk9knk1glk9QiydgxRiDy9hKxfQd5cRa4dQu6dgXfXcdkOxsqocAQ2pse9vAwf1lTha2RrHYm3kZ8bIRW+EDKmQ5IImW+FQoXs6OaiKFMftmWK+Dztq94/x+g/tJFh6pJl24wOld6CJNebUBviJFXLdN6yu5eG/axs2I1TsqoN6z+6XzSGearNXpTYvj+o0Gov+b/4JvU92YTrpfOq0htSEMdxePvr2bZtEOD8d829952U/gUS+JFJWMKWMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ae loss 1 unscaled\"\n        title=\"ae loss 1 unscaled\"\n        src=\"/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/f058b/ae_loss_1_unscaled.png\"\n        srcset=\"/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/c26ae/ae_loss_1_unscaled.png 158w,\n/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/6bdcf/ae_loss_1_unscaled.png 315w,\n/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/f058b/ae_loss_1_unscaled.png 630w,\n/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/40601/ae_loss_1_unscaled.png 945w,\n/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/78612/ae_loss_1_unscaled.png 1260w,\n/vynsblog/static/58ea1b21f64e5f95b06125ff41569821/c9d77/ae_loss_1_unscaled.png 1964w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<em>Note</em>: Since beta = 0, the GAN loss has no effect on the modelâ€™s training.</p>\n<p>This is the same graph as above, but GAN loss is multiplied by 0.005.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/51bf3543a2dc0ad0db91a353f16674c5/75a80/ae_loss_1_scaled_005.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.75949367088608%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA9hAAAPYQGoP6dpAAABr0lEQVQoz41T20oDMRDtn/oiPuijz36E4A8IIiqIIj4JgpeKdwXFK2rVl2JbYZtNdjfX40y2rrUt6MLJTDLJ2ZPMTC2EAP5C8HDO/UKWZZBSVuC5UqqMew8+68kySo6AGjvWWkjaqI2J/jfSNEWSJBV4LoSIsTzP0Ww20Wq1YuybNBIGmnSlQmYc/v15vkGp1pAQtn2EDkmqIAtbSf8TfdyseICQFBJhpt0P4T+JRxIarUmhHFKIQZTBCiVhGCbUuoBQWbSweUlIz1AhHiNwjK3TsSpCLxHWuoErUzAREu2uHJ0ATeuiCaQfQPIOvOyWYk0GqA5soWIZVYTWeRjVxcX5EdpHS7DnC/A3G/Bn8/AHc/DrU/CrE/BrZNcm4ZfH4DenEbZmgNVx2E4DrvccNR6cDyjEJ8zeLJLjRXQOF/G0v4Lb/XXc7izj7nQbD5d1PFyd4L7xhufrY7yebKJxVcfjSwMy11SHrl+hQyoSaFLJwjNDP6DH4i2K8mT41hRQNDhaz22AoqAmv6uK2D1VYVfJ41otawiWC9Wanq9R5NSCqYg+73TcST3f0r7+1vsCW6if9CBu5DYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ae loss 1 scaled 005\"\n        title=\"ae loss 1 scaled 005\"\n        src=\"/vynsblog/static/51bf3543a2dc0ad0db91a353f16674c5/f058b/ae_loss_1_scaled_005.png\"\n        srcset=\"/vynsblog/static/51bf3543a2dc0ad0db91a353f16674c5/c26ae/ae_loss_1_scaled_005.png 158w,\n/vynsblog/static/51bf3543a2dc0ad0db91a353f16674c5/6bdcf/ae_loss_1_scaled_005.png 315w,\n/vynsblog/static/51bf3543a2dc0ad0db91a353f16674c5/f058b/ae_loss_1_scaled_005.png 630w,\n/vynsblog/static/51bf3543a2dc0ad0db91a353f16674c5/40601/ae_loss_1_scaled_005.png 945w,\n/vynsblog/static/51bf3543a2dc0ad0db91a353f16674c5/75a80/ae_loss_1_scaled_005.png 1134w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/955d9c504413e97573f32fa435bb2583/6af66/discriminator_loss_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABrElEQVQ4y4WUi27iMBBF+f//2l9Y1ErQqkBJSt6O4/h5O2NM1qGp1tLg5xyur+3sQCWEgK3C41rrVTjn8Fvh9bsHjBdLKaGUwjRNmOcZwzDgcDisoiwLWjNDjBKjEBAUnOe9j5wI5BjHEcaYOKGNhZg0ArVz9Y+1clK4VTWOxyP2+z1Op1MUFIH8w6ratl2SrQvoJ7OCpM69drR1NaDvBzRNE3N5R4tCLjzw8Mc4/wO4ig3vWNSikGFd1y0+MLDLgHni1p9Ya9fA6AsZmyvs5DYw9jNYdIDyFiAfBPvAAzmwlfofJPmXQ34FPk647/vVlnMgnnzLoZtALnz3vE8K7RMwKRSKr9V/FMYBUjaQQqkteH2wM4yoUmK6i1TPooaPtuTbD9sKNXk5iTb55eHH6sfTcrLB1iNlq1YKeat116N7/YP+9BequUCXr7BjDdN/RbWWQl1fYId739HcnOa0kpieFfKbbG4FquKC8vOMW/GJ6uuKgtpVecX5453mS3y8H9HWt1jH/tsBkg7Vphuye/7ShKg4kJcpqN2R+vPlAhVfk48v0NBlvtdudfrfKoKXgR+Nn2EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"discriminator loss 1\"\n        title=\"discriminator loss 1\"\n        src=\"/vynsblog/static/955d9c504413e97573f32fa435bb2583/f058b/discriminator_loss_1.png\"\n        srcset=\"/vynsblog/static/955d9c504413e97573f32fa435bb2583/c26ae/discriminator_loss_1.png 158w,\n/vynsblog/static/955d9c504413e97573f32fa435bb2583/6bdcf/discriminator_loss_1.png 315w,\n/vynsblog/static/955d9c504413e97573f32fa435bb2583/f058b/discriminator_loss_1.png 630w,\n/vynsblog/static/955d9c504413e97573f32fa435bb2583/6af66/discriminator_loss_1.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/21b4d/discriminator_accuracy_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAB7CAAAewgFu0HU+AAABo0lEQVQ4y51U2XKDMAzM//9g0oMcfWmHBBt8X3hrmZCGtsmk9YwAC3mRdiVWuLNiSggxVosx1T1ZvhGfc8aKLs45WGshlYZQBlprWCXwtt9i37xg+/qM/fYVh12DXdmzUwtnFEyJqaYVxnGsoCt6OB6P6PsewnhwZdG174iqQzZ9uXMYMT0nzatFxS6WNKsf9yFMgHRxztesprwjtChBadoKN8In3F0hRHjvvwCFEMWGiRs7IHqH3kxfHErWMVE5uXL03WgR2AWQnJxzDMNQUpXIujsDBYzlnbABIY0X0r+L8AOQwEgQKjmngHwmt/8vIAnSdV0tuwadg21IUC5C2liB/wRIYEqpBS9pzDhJB1lAfwO7CUhtwxibOLwKIiE65WuWs/+hDGfH1DbLA0x79NovAB9SWZdOH0rZIeX6giYnxYB2sOA6LLj9vQ/DEpA4PBUuOTuiaRqs1xs8bdY4fLAqDilP1KQyx9f32SiBBWAswy+lAC8zSuKQUMQpcWuMqT7qBDo0+6jdaFyJqrZtL+WvFiTfUFFKWQ9d+645nH8MtP8El0aXbdtem44AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"discriminator accuracy 1\"\n        title=\"discriminator accuracy 1\"\n        src=\"/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/f058b/discriminator_accuracy_1.png\"\n        srcset=\"/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/c26ae/discriminator_accuracy_1.png 158w,\n/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/6bdcf/discriminator_accuracy_1.png 315w,\n/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/f058b/discriminator_accuracy_1.png 630w,\n/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/40601/discriminator_accuracy_1.png 945w,\n/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/78612/discriminator_accuracy_1.png 1260w,\n/vynsblog/static/fdd6744f32701b05230afae621b1b9ce/21b4d/discriminator_accuracy_1.png 1280w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Looks like the result of training a typical autoencoder, so I think itâ€™s working for that part of the loss function.</li>\n<li>Learning rate could be reduced.</li>\n</ul>\n<h4>Below is the training evolution over 36 epochs.</h4>\n<p><img src=\"/vynsblog/9056e84f2d31bfa946027cee0a5042e6/training_1.gif\" alt=\"\"></p>\n<h3>Verification test 2</h3>\n<ul>\n<li>If alpha = 0 and beta = 1, should get same result as training a typical GAN. Although, with the caveat of the generator being autoencoder shaped. So results from this test may be varied.</li>\n<li>This test will likely result in failure to converge because the generator is shaped like an autoencoder not a typical GAN generator. GANs can be pretty sensitive to changes in network architecture.</li>\n<li>Iâ€™m hoping the combination between alpha and beta will allow the discriminator to be fooled and prevent convergence failure.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/752a0d9ac4098c41d86f9fc4932d41dc/0a867/ae_loss_2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.15189873417721%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABiUlEQVQ4y42TWVLDMAyGe/+zcAQuwPBYnmBgpiyBJk2zeYmX+Edy4pK001DPKIo91uffsrQJIYCHdw7WWljyjqzvexwOB+R5Hm2/36OuaxRFASll3Mf7jTFxb+Js0o9hmNHwRsEPQ4Ty5hTAlgDs26bBbreLh/HB3vsRyB8OFnQq0Yjc4ZYRBh/hKX4BDKRIs2zXE1CANbPyNZsPVrwADgzUDKQTRR6B4KAUOPkIm+Zz8AXQe0eJVgjeAs3nUsGZmsW1rwG11n8Km6+lwhW7CuQFISQpdEC1G3PJap1Zf5hTDmePkk7p6cU4l3h/QEgvLQpAVWRHukZ9YWHyVstYaouy6bpufN3tHcLLPcLPE8L3FqF8RSieR1++zfxooLkVRwKeFTZfm0sGn48ktxlr8sZhnZ/lcCoFKQS64gNdmaFWDq0yZD3qltbJt1KjESr+V7SW5nUnIZUa03WuUPUGzgc01FZK6dhuVVXFgCzL0LRtTE9ZHmPOuacr6m9eO/XyvJ7W6i0p+G/fL94SSu1L52TRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ae loss 2\"\n        title=\"ae loss 2\"\n        src=\"/vynsblog/static/752a0d9ac4098c41d86f9fc4932d41dc/f058b/ae_loss_2.png\"\n        srcset=\"/vynsblog/static/752a0d9ac4098c41d86f9fc4932d41dc/c26ae/ae_loss_2.png 158w,\n/vynsblog/static/752a0d9ac4098c41d86f9fc4932d41dc/6bdcf/ae_loss_2.png 315w,\n/vynsblog/static/752a0d9ac4098c41d86f9fc4932d41dc/f058b/ae_loss_2.png 630w,\n/vynsblog/static/752a0d9ac4098c41d86f9fc4932d41dc/40601/ae_loss_2.png 945w,\n/vynsblog/static/752a0d9ac4098c41d86f9fc4932d41dc/0a867/ae_loss_2.png 986w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4>Below is the training evolution over 69 epochs.</h4>\n<p><img src=\"/vynsblog/45fdf60679016ea6fedb5e5a9889210d/training_2.gif\" alt=\"\"></p>\n<h2>Test using alpha = 1, beta = 0.005</h2>\n<ul>\n<li>Learning rate reduced to 0.0001 (was 0.0002). Iâ€™m hoping this will provide better performance and reduce training time due to the volatility of the reconstruction loss.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/a07de/loss_verify_3.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.63291139240506%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHr7YSkTpNCP//EABkQAQADAQEAAAAAAAAAAAAAAAEAAhESIv/aAAgBAQABBQLt2zlj1XsjbHZwRqKGH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABgQAAIDAAAAAAAAAAAAAAAAAAABEBEh/9oACAEBAAY/AmYJxRk0f//EABoQAQADAQEBAAAAAAAAAAAAAAEAESExQdH/2gAIAQEAAT8hRLKGoglN+zYKWeTVL3nIAJLYJBAjNL3ty0MIhwn/2gAMAwEAAgADAAAAEPA4Av/EABcRAAMBAAAAAAAAAAAAAAAAAAABEIH/2gAIAQMBAT8Qys//xAAXEQADAQAAAAAAAAAAAAAAAAAAARCB/9oACAECAQE/ENqP/8QAHRABAQADAAIDAAAAAAAAAAAAAREAITFBUZGxwf/aAAgBAQABPxCIHyh9hv5w5gCo28H7lohsFrO9Q9Ltn3hoGwIvmYPALbMXSUvk5u4TtokOduVIhC5//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"loss verify 3\"\n        title=\"loss verify 3\"\n        src=\"/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/828fb/loss_verify_3.jpg\"\n        srcset=\"/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/ff44c/loss_verify_3.jpg 158w,\n/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/a6688/loss_verify_3.jpg 315w,\n/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/828fb/loss_verify_3.jpg 630w,\n/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/0ede0/loss_verify_3.jpg 945w,\n/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/3ac88/loss_verify_3.jpg 1260w,\n/vynsblog/static/e3af4acbb51a81d69bce0b4ced58e4af/a07de/loss_verify_3.jpg 1287w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/431f2fb2e47a57b1a0d80342e087a617/6af66/ae_loss_3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACKklEQVQ4y41UTY/TMBDtf+dXICEOSFxAqAcuCCRAiMOKVaGoZWkVkibZJG0+Gjdx4nzYycP2kpJsF4mRRm8qO288b2Y6g7S+7xWgbVs0TaNxiAfnnGsUEruu0+cDDt8rnI3JHNuGYRiwJVqWBdM0z+g4DrbbLXaOiyAIdOz7PjabDcIw1GRnQlaWiI8pjrQ+ZxoSDaZ+CyGQ0RKu6+okijCOYyRJgqqq9L3Z3UWOhOTYxRRjCS5QloiagtIchBAtgzKFE8KKMezjFCuPTF543/UZLk29fEKo9FNlW1GOmncXZY/xoSQXhEVRgBUUYcYmhBP8X0KlBWMV2rqCnxZoRQfR9XIkenCp2UXJD7x8QqjKzXJZKitghDnm3zyQstGHZcOnWv1J1I1feZ9w6FJdMSS0wqPXazz+aOCLlWDtnRBJGQ5ZBdYK/MtU9yca5vndGChTCl7fFni5jPD0ysfzRYgnn0y8urbx9sceV2aMn8EJ+xODT0p4aQnKGtT1iFCVwIoc4nYBHNYAdaXvZLyUvgLM96jqBhbhuDmUWPoUSy/Hws3w2Uw1MW/qv4RKQ5Km4MYHdItnENt34Ks5xHqOfvMG3fcXQPAVyGwpbAAU0psjwCK5swRdLadkXLLSkFKKU16AFA2iU4kkr+UqNgh1LCfANpCGHlzLAIkPcHa/cIwUmijkt6ox56aMFhadXEPB5T+JctHqmKRHeH6gy+ZyrFRnWy7UdY3jff8NzzCFf6gbpaUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ae loss 3\"\n        title=\"ae loss 3\"\n        src=\"/vynsblog/static/431f2fb2e47a57b1a0d80342e087a617/f058b/ae_loss_3.png\"\n        srcset=\"/vynsblog/static/431f2fb2e47a57b1a0d80342e087a617/c26ae/ae_loss_3.png 158w,\n/vynsblog/static/431f2fb2e47a57b1a0d80342e087a617/6bdcf/ae_loss_3.png 315w,\n/vynsblog/static/431f2fb2e47a57b1a0d80342e087a617/f058b/ae_loss_3.png 630w,\n/vynsblog/static/431f2fb2e47a57b1a0d80342e087a617/6af66/ae_loss_3.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\nBelow is the same graph, but zoomed out. Notice the spike, then recovery? AE loss seems to keep GAN loss under control, potentially causing the network to recover from convergence failure?\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/be9fdf1e9ddd5bc493fbf5712178a31b/7161f/ae_loss_3_zoomed_out.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.41772151898735%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABMElEQVQ4y62T226EMAxE+f+vbB/agoDAbsidZGqHZRsQXYFapFFMZB8cnKlSSvivh1kVBzFGGGOhtIZSE8UG4ziibVt0XZdXlhACwzCg73vKUwghwHufNc9zhlYrmUFNU+dkBnICJ3LRkWJMSMGRLCLVO+d+gFxsCXL5IRi8zqH3btvh+gWOT4lzH8C0B3KH5tFhWbS+H/z9ZfkNuO/wxDhfA7m7ssM/A/naWGtPA9NV4P7/7fdKYDocSgaa53HOThlOEkkdD8VQhz4CV4wYZAenbjneXGw+siYrfTUNmvqDbCdwl/csKSXktGiaJpLMUprsWb+h/XyH82RBt++QphyMhNMSt3HIXjZG55U93IuefCzyB3i/pz1NdnUUs7/nOSzAcqrpxVT5FOUF2NQV8TfwsJ9fkgUZ4QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ae loss 3 zoomed out\"\n        title=\"ae loss 3 zoomed out\"\n        src=\"/vynsblog/static/be9fdf1e9ddd5bc493fbf5712178a31b/f058b/ae_loss_3_zoomed_out.png\"\n        srcset=\"/vynsblog/static/be9fdf1e9ddd5bc493fbf5712178a31b/c26ae/ae_loss_3_zoomed_out.png 158w,\n/vynsblog/static/be9fdf1e9ddd5bc493fbf5712178a31b/6bdcf/ae_loss_3_zoomed_out.png 315w,\n/vynsblog/static/be9fdf1e9ddd5bc493fbf5712178a31b/f058b/ae_loss_3_zoomed_out.png 630w,\n/vynsblog/static/be9fdf1e9ddd5bc493fbf5712178a31b/40601/ae_loss_3_zoomed_out.png 945w,\n/vynsblog/static/be9fdf1e9ddd5bc493fbf5712178a31b/7161f/ae_loss_3_zoomed_out.png 1182w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/530b2d4e51bc8dad97fbd2f92b9fccad/33e10/discriminator_loss_3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.58227848101265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACBElEQVQ4y32Uy4+VMBTG59/VGOPKvf+FKxdqTCa+Fm4nk5jMwqgTo0aj8c7rAjM8LuXZUmjL5ylckHthbHIoKYdfv57vwAFotG2L24ZSCnVdd9E0zX9z7bODIcEmCyEgpeyiqqoOwhiD53ld+L4PzjmtS8qtkOYF4jhGkiTQWnecESgIoGVB22i0292W1AxrWjVI4ggXF5dwHKfbfAJsIWQNIzKSKjogti8O4NkGk3tjzD4QqOnIOvUAHo8Ksae0v+9h0xx73BE4PORlCbM5o7Mno8Kpoil0f6Md4KiQFrQFlhHa4dh0bbSBmUKW6rmj0BpC7hZFTgrPCRgCZM7wYlY1BNVj2ZZUz4BWgRAcKvyDinlQVd4732jcZJLMSilJ7Zh1K/CfKQrN+hS58xNJmiGXGtcR9WBSoSkZdVO9aNKiKTY4NWp9+RHZ6gOycI3vbgoWOGAJQxZ528ZtF9qoXVYolcH6/VO4z+/i6ugxfp28xe/jZzg9fo3g0xtInm9tmg9j2jmQ8xKrz0cI3j1CcPgAm8N7CF/cgf/qIdjL+2AnT1A7X2Cuv0F7X9FSR6ibH2hSHzVPuz7eA3IUXIArcpZLFEIiLwVKmotKIfI9FMEVYvcMBZVk465QbjyE7jlEkc2/5b7I1HNa0XdKYWdKsrMg9ZuYgarShbE/E933pO3Tqet/AbldjOJ6M9eFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"discriminator loss 3\"\n        title=\"discriminator loss 3\"\n        src=\"/vynsblog/static/530b2d4e51bc8dad97fbd2f92b9fccad/f058b/discriminator_loss_3.png\"\n        srcset=\"/vynsblog/static/530b2d4e51bc8dad97fbd2f92b9fccad/c26ae/discriminator_loss_3.png 158w,\n/vynsblog/static/530b2d4e51bc8dad97fbd2f92b9fccad/6bdcf/discriminator_loss_3.png 315w,\n/vynsblog/static/530b2d4e51bc8dad97fbd2f92b9fccad/f058b/discriminator_loss_3.png 630w,\n/vynsblog/static/530b2d4e51bc8dad97fbd2f92b9fccad/33e10/discriminator_loss_3.png 844w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/f75536a37bf28831971a2338ffffa107/6af66/discriminator_accuracy_test_3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAABoUlEQVQ4y6WTyXajMBBF8/9/51XHGUhnkTaIGIRmIeHXVXLAODHehHPqQAnV1atBD6fTCVtPShlxHIuNKS22FcGsh3Nggvcezlp4a8h0sfe/FZ73j2R/8Pb6jLfqBa8vTzi2TdlntIIzqsTlaSrQAlRao+s62F5A1u/oxAdEc0AcGgTdI+ojvPqElp/IThY/kO+kwMjfjkT4cAbOKSs1wJsB0iUIHXG0lNq33LZSnUgdZ7goZKfrey4COkswE5aarA3f/FlMzvkC5EU+wVIdLsC4AL8+rgBn9gbQGAMpZTFOimHdCrgOvNXVH0AGaWqKda4c3epAdRyvFd4Zk5vAYRigSSkrbAYP7X8B5MUYY4Ey8J/0sDHdBF5qeKcp82ArpQvwo3dwY77Z5a16/hibEMKXQqBRASFNd1PN04muYC5xDJrfC5AlK6Uw5QRpCTimooTX2VjB7E8EC96ipZu03++x2+1QVVUp29VNcdRlvn7zaW3bgkeKN/Y09OzzP54GUR9glCz/67qGEKIcuihcF3tdl/nhcjRNc0k5T1eNWsf/BwBbl7VDVFiiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"discriminator accuracy test 3\"\n        title=\"discriminator accuracy test 3\"\n        src=\"/vynsblog/static/f75536a37bf28831971a2338ffffa107/f058b/discriminator_accuracy_test_3.png\"\n        srcset=\"/vynsblog/static/f75536a37bf28831971a2338ffffa107/c26ae/discriminator_accuracy_test_3.png 158w,\n/vynsblog/static/f75536a37bf28831971a2338ffffa107/6bdcf/discriminator_accuracy_test_3.png 315w,\n/vynsblog/static/f75536a37bf28831971a2338ffffa107/f058b/discriminator_accuracy_test_3.png 630w,\n/vynsblog/static/f75536a37bf28831971a2338ffffa107/6af66/discriminator_accuracy_test_3.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Test using a pre-trained AE as a generator to the GAN</h2>\n<p>Steps:</p>\n<ul>\n<li>Train AE to reconstruct images from the original dataset.</li>\n<li>Train GAN using the pre-trained AE. AE weights will get updated during that process.</li>\n</ul>\n<p>Original dataset\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/804fcb00f8a6b54cbc222eccfd73f1e4/6af66/dataset_original.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACxUlEQVQ4y42U2U8TURTG+Xc08Yk/wviqiUvig0tIjMYQH4giIBJEqcqSSC1WpOwERSi0xTaUJV2Q0r2Udrrv0GFaLRRBoO3ncC8UoZJ4H+bO78zNd8/57plbBn4UCgWcHiWxU1w4g8uOXvL5PNJrcQTdTmxuZklsg41jh4thd3sLB6syPG+zEexs0e+hoB8x7wqyG5miaFFwd28fsvZGvLp+CVbjEomNN1bC0XIf2dUAYUbaAf3rCoSWTYQXRiUwiJoQMH8/TCp3LPibF1R8EmG4oQoBn5fEhloFmG+rQ5rjCAe0E1jsf4N42E/YPTMJ19deMHZLscqiYG4/B9NUL2b6mvjSoySm7hFCI2oGFw/REi3TmOupR4ShAtYxMVY+vwUXYWjJJwRzORilIuh763kBHy1ZUAtF9QNwYcpL8i5UXS6HfXGWWjDcgshoM/KZ+KGHfwkezAmjHL6pTmyuJ8ghODRquNUyrCcTNKP5cQy01sDldBBmGSPiugnEAr7SDPd295AYqYGx7iI8FgOJaQc/Yq79BdaC1NPxl/cwdPcCFtRywhZZH1RPb8FnNv77ULzKQSyJG+H3UdMd2lnYlTIkEzHCBlk/9J21fGstE9ZPf8OU+B24WPRkhkc9Ghj5AMXDO0h4aQlhywy8+kkko3QDRj4Mczvvsd9FeFD4GFXXzsFl1ZRmuM+rm0St6Lp5AyE3QzycHRVDPyBANEhP0TAiwfSzSoTdbsIqyRMIbp8H4yzpwwLy/NOmVUH6/jniEdomK+ovsI8J8TO1SjPWqRCRdyMVohuETGqwVikyMW/pKef5qbupEsKKcrBB6pGuoxqamqs8Owkr2+qhfHQFMauOJOBRdCIlb8APZvHQw9zJtgk4zbDwWW5nN0jJrMeGdZsOW5k0WeOxmXhP1chwLOE039C/InZkU8njf/ms2+Z/b5fT/Af/NjOWNe0ihwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"dataset original\"\n        title=\"dataset original\"\n        src=\"/vynsblog/static/804fcb00f8a6b54cbc222eccfd73f1e4/f058b/dataset_original.png\"\n        srcset=\"/vynsblog/static/804fcb00f8a6b54cbc222eccfd73f1e4/c26ae/dataset_original.png 158w,\n/vynsblog/static/804fcb00f8a6b54cbc222eccfd73f1e4/6bdcf/dataset_original.png 315w,\n/vynsblog/static/804fcb00f8a6b54cbc222eccfd73f1e4/f058b/dataset_original.png 630w,\n/vynsblog/static/804fcb00f8a6b54cbc222eccfd73f1e4/6af66/dataset_original.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\nReconstruction after pre-training AE\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/vynsblog/static/a781edd9fa7864226e4c784989e5398d/6af66/ae_training_test.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACyklEQVQ4y51UWU9TQRjlL5nwpH9AH0xIjInRaOKTIRpNTHhQGzAVW1FSYxFQy1JITDVQllZatTSk2IWlCy10v23vLd036ILQ9djOLQWKvjgP9845MzlzvmWmA/VRq9XQPs5xbbj2D9xxPKlWq8hEQ6BdO8jncoTLxkM4Su2ieHiAxq5sIozfcQaHhTxZDwb8iFIOHOT2W6ItwWKpBKWQC8Hty7Aa1wkn5z+C7d195CN+gl3SERj49xDc3iR4TToJyxgXtEXfNFU5ETwqlvBz+gPm+T2gvW7CzQ8PQDvch71kjGC/Rg7TlABRmiLYrVmCUz4Fr83cirIlWCmXYZZNQTc5gL1okHDL0yPQiV4hFaIJZjbV0I7zEHZZCbYtiOCafYNMkDVQOyNYqWBrdgwmUT/SQS8b8iAHyt5upBkWWxcmwOu6CId+hU3BFwGCMwMoZ5hmDk8JNv5RowIBxUcUkhFSBLt2GZ4VGVKxMNmzU5/PCXrhtW8THPeYENTLEPZ7zjssFYsIfeXA2HcFlHmNcDqJCKvvuYj73eQAxcsHWLzbiQ3VElnfWhRD1XsH/r8VpVgqg1JJYJrkI0CxSXfoNbCrZEhEdgk2f5PA/OkFaCfrcF2lxIpYiHSYPuvwuEc9c0NYenoLEZ+LYHpDDd+qDEmGPcCl+IyNYQ4SPifBM4PPwLt6AV5T02HllMNyXX1d/Bri7i7QbjsJUT8zAdP0W4QpVsBY7ztV/0ME681PUjL6HOLrnfBZDO0h19girP6AYoiLGMM2slMthV06ilwyStYZw3cwinGkaTYCxqRGwriI/ZD3fJWr9Z+E+xgTNy8hQdkJpxc+gZZzA0mKdaQS9uFHzzWELL9QbRwoFyE2x0PaYWjm8FTIjW9gxwK7RonDfJbghNuKhFWHg/002eO1mkEZ1Mg2b06GcaNA21BIxU7ucuul+M/XpR3/AVqNNh5UAW21AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ae training test\"\n        title=\"ae training test\"\n        src=\"/vynsblog/static/a781edd9fa7864226e4c784989e5398d/f058b/ae_training_test.png\"\n        srcset=\"/vynsblog/static/a781edd9fa7864226e4c784989e5398d/c26ae/ae_training_test.png 158w,\n/vynsblog/static/a781edd9fa7864226e4c784989e5398d/6bdcf/ae_training_test.png 315w,\n/vynsblog/static/a781edd9fa7864226e4c784989e5398d/f058b/ae_training_test.png 630w,\n/vynsblog/static/a781edd9fa7864226e4c784989e5398d/6af66/ae_training_test.png 640w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\nResult after 100 epochs of training GAN\n<img src=\"/vynsblog/8ad40b0cee9fef2301f255c6193fdb1e/pretrained_ae_gan.gif\" alt=\"\"></p>\n<ul>\n<li>Images tend to be the same regardless of the input.</li>\n<li>Using a pre-trained model for the AE seems to disconnect the relation between the input and output of the AE during the GAN training process.</li>\n</ul>","frontmatter":{"title":"AE GAN Experiments","date":"April 01, 2022","description":""}},"previous":{"fields":{"slug":"/wk-11-gan-optimizations/"},"frontmatter":{"title":"GAN Optimization Experiments"}},"next":null},"pageContext":{"id":"b9f0418c-09e6-5ea8-8069-05aa6f0bbe66","previousPostId":"fc4ca0b5-ed46-50f6-87af-2529416d13b1","nextPostId":null}},
    "staticQueryHashes": ["2841359383"]}